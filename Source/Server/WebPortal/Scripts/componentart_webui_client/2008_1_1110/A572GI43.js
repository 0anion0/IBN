function ComponentArt_WhiteWash(_1){var _2=document.createElement("DIV");document.body.appendChild(_2);_2.style.position="absolute";_2.style.top=_q85(_1)+"px";_2.style.left=_q86(_1)+"px";_2.style.height=ComponentArt_GetAdjustedHeight(_1);_2.style.width=ComponentArt_GetAdjustedWidth(_1);_2.style.zIndex=99000;_qF2(_2);}function ComponentArt_EnableDisableChildControls(_3,_4){for(var i=_3.ChildControls.length-1;i>=0;i--){var _6=_3.ChildControls[i];if(_6.set_enabled){_6.set_enabled(_4);}else{if(_4&&_6.enable){_6.enable();}else{if(!_4&&_6.disable){_6.disable();}}}}}function ComponentArt_ReplacePaths(_7){var _8=new Array();var _9="src=[^>]*['\" ]";var re=new RegExp(_9,"gi");var m=re.exec(_7);while(m!=null){_8.push(m);m=re.exec(_7);}for(var i=_8.length-1;i>-1;i--){if(cart_browser_mozilla&&_8[i][0].toLowerCase().indexOf("http://")==-1){var _d=location.href.substring(0,location.href.indexOf("/",10));var _e=_7.substring(0,_8[i].index)+" relative"+_8[i][0]+" ";if(_8[i][0].substring(4,5)=="\""||_8[i][0].substring(4,5)=="'"){if(_8[i][0].substring(5,6)=="/"){_e=_e+_8[i][0].substring(0,5)+_d+_7.substring(_8[i].index+5);}else{_e=_e+_7.substring(_8[i].index);}}else{if(_8[i][0].substring(4,5)=="/"){_e=_e+_8[i][0].substring(0,4)+_d+_7.substring(_8[i].index+4);}else{_e=_e+_7.substring(_8[i].index);}}_7=_e;}else{_7=_7.substring(0,_8[i].index)+" relative"+_8[i][0]+" "+_7.substring(_8[i].index);}}return _7;}function ComponentArt_CloneStyles(_f,_10){if(!_f||!_10){return false;}var _11;if(_10.styleSheets.length==0){if(_10.createStyleSheet){_10.createStyleSheet();}else{css=_10.createElement("style");css.media="all";css.type="text/css";_10.getElementsByTagName("head")[0].appendChild(css);_11=css;}}if(_10.styleSheets[0]){_11=_10.styleSheets[0];}for(var i=0;i<_f.styleSheets.length;i++){try{var _13=_f.styleSheets[i];var _14=(_13.rules)?_13.rules:_13.cssRules;var x=0;for(var j=0;j<_14.length;j++){var _17=_14[j];if(_11.addRule){var key=_17.selectorText;var _19=_17.style.cssText;if(_19&&key){_11.addRule(key,_19,x);}}else{if(_11.insertRule){_11.insertRule(_17.cssText,x);}else{var _1a=_17.selectorText+"{"+_17.style.cssText+"}";_11.appendChild(_10.createTextNode(_1a));}}x++;}}catch(err){}}}function ComponentArt_SelectElement(_1b,_1c){selectionObj=new Object();selectionObj.StartOffset=0;selectionObj.CommonAncestorContainer=selectionObj.StartContainer=_1c;if(_1c.nodeType==3){selectionObj.EndContainer=_1c;selectionObj.EndOffset=_1c.nodeValue.length;}else{var _1d=_1c.childNodes[_1c.childNodes.length-1];var _1e=_1d.nodeType==3?_1d.nodeValue:_1d.innerHTML;selectionObj.EndContainer=_1d;selectionObj.EndOffset=_1e.length;}_q162(_1b,selectionObj);}function ComponentArt_IsTableEmpty(_1f){if(_1f.rows.length==0){return true;}for(x=0;x<_1f.rows.length;x++){for(y=0;y<_1f.rows[x].cells.length;y++){return false;}}return true;}function ComponentArt_GetTDInfo(td){var _21=td.parentNode.parentNode.parentNode;for(x=0;x<_21.rows.length;x++){for(y=0;y<_21.rows[x].cells.length;y++){if(_21.rows[x].cells[y]==td){var _22=new Object();_22.row=x;_22.col=y;_22.td=td;_22.table=_21;return _22;}}}return false;}function ComponentArt_FocusElement(_23,_24){selectionObj=new Object();selectionObj.StartContainer=selectionObj.EndContainer=selectionObj.CommonAncestorContainer=_24;if(_24.childNodes.length>0){selectionObj.StartContainer=selectionObj.EndContainer=_24.childNodes[0];}selectionObj.StartOffset=selectionObj.EndOffset=0;try{_q162(_23,selectionObj);}catch(err){}}function ComponentArt_InsertBefore(_25,_26,_27){try{if(_25){_25.insertBefore(_26,_27);}else{if(_27.parentNode){_27.parentNode.insertBefore(_26,_27);}}}catch(err){try{if(_27.parentNode){_27.parentNode.insertBefore(_26,_27);}}catch(childerr){}}}function ComponentArt_Swap(_28,_29){var _29=document.getElementById(_29);if(!_29){return;}var _28=document.getElementById(_28);if(!_28){return;}_29.parentNode.removeChild(_29);ComponentArt_InsertBefore(_28.parentNode,_29,_28.nextSibling);_28.parentNode.removeChild(_28);}var _q87={"H1":1,"H2":1,"H3":1,"H4":1,"BR":1,"HR":1,"DIV":1,"P":1,"UL":1,"OL":1,"LI":1,"TABLE":1,"TBODY":1,"TD":1,"TR":1};var _q88={"UL":1,"OL":1,"TABLE":1,"TBODY":1,"TR":1};var _q89={"BR":1,"IMG":1,"INPUT":1};function ComponentArt_SerializeDomElements(arr){var _2b=[];for(var i=0;i<arr.length;i++){if(arr[i].normalize){arr[i].normalize();}_2b[_2b.length]=ComponentArt_SerializeDomElement(arr[i]);if(!cart_browser_ie&&_2b[_2b.length-1].substring(0,1)=="\n"&&_2b[_2b.length-2]&&_2b[_2b.length-2].substring(_2b[_2b.length-2].length-1)=="\n"){_2b[_2b.length-2]=_2b[_2b.length-2].substring(0,_2b[_2b.length-2].length-1);}}return _2b.join("");}function ComponentArt_SerializeDomElement(o){var _2e=[];if(o.tagName){_2e[_2e.length]="<"+o.tagName.toLowerCase();if(o.attributes&&o.attributes.length){var _2f=null;if(o.attributes["relativesrc"]!=null){_2f=o.attributes["relativesrc"].nodeValue;}for(var i=0;i<o.attributes.length;i++){if(o.attributes[i].specified&&o.attributes[i].nodeName&&o.attributes[i].nodeName!="relativesrc"&&o.attributes[i].nodeName!="depth"&&o.attributes[i].nodeName!="_moz_dirty"){if(o.attributes[i].nodeValue&&o.attributes[i].nodeValue!="_moz"&&o.attributes[i].nodeValue!="null"&&o.attributes[i].nodeValue.replace&&o.attributes[i].nodeValue.replace(" ","")!=""||!o.attributes[i].nodeValue){var _31=o.attributes[i].nodeName;var _32=_31=="style"?o.style["cssText"]:o.attributes[i].nodeValue;if(_31=="src"&&_2f!=null){_2e[_2e.length]=" "+_31+"=\""+_2f+"\"";}else{_2e[_2e.length]=" "+_31+"=\""+_32+"\"";}}}}}if(o.normalize){o.normalize();}if(o.childNodes&&o.childNodes.length){if(o.childNodes.length==1&&o.firstChild.nodeType==3){_2e[_2e.length]=">"+o.innerHTML;}else{_2e[_2e.length]=">"+((_q88[o.tagName]&&o.innerHTML.substring(0,1)!="\n")?"\n":"")+ComponentArt_SerializeDomElements(o.childNodes);}_2e[_2e.length]="</"+o.tagName.toLowerCase()+">";}else{if(o.innerHTML){_2e[_2e.length]=">"+o.innerHTML.replace(/^\s+|\s+$/g,"")+"</"+o.tagName.toLowerCase()+">";}else{if(!_q89[o.tagName]){_2e[_2e.length]="></"+o.tagName.toLowerCase()+">";}else{_2e[_2e.length]=" />";}}}if(_q87[o.tagName]){_2e[_2e.length]="\n";}}else{_2e[_2e.length]=ComponentArt_GetSerializedHtml(o);}return _2e.join("");}var helperDiv=null;function ComponentArt_GetSerializedHtml(o){var _34=o.ownerDocument.createElement("div");if(o.normalize){o.normalize();}_34.appendChild(o.ownerDocument.createTextNode(" "));_34.appendChild(o.cloneNode(true));_34.removeChild(_34.firstChild);var _35=_34.innerHTML;_qF2(_34);return _35;}function ComponentArt_RemoveElements(_36,_37,_38){}function ComponentArt_RemoveElementsRecurse(_39,_3a,_3b){}function ComponentArt_RemoveElement(_3c,_3d){if(_3d.childNodes){for(var i=0;i<_3d.childNodes.length;i++){_3d.parentNode.insertBefore(_3d.childNodes[i],_3d);}}_3d.parentNode.removeChild(_3d);}function ComponentArt_AddChildDom(_3f,_40){var _41=_q10F(_3f.element);_40.innerHTML=_41.CommonAncestorContainer.innerHTML;_41.CommonAncestorContainer.innerHTML="";_41.CommonAncestorContainer.appendChild(_40);_41.CommonAncestorContainer=_41.StartContainer=_41.EndContainer=_40;_q162(_3f.element,_41);}function ComponentArt_SwapDomElement(_42,_43,_44,_45){var _46=_43.innerHTML;ComponentArt_InsertBefore(_43.parentNode,_44,_43);_43.parentNode.removeChild(_43);var _47=_44;if(_45){_47=_45;}_47.innerHTML=_46;var _48=new Object;_48.StartContainer=_48.EndContainer=_48.CommonAncestorContainer=_47;_48.StartOffset=_48.EndOffset=0;if(_47.innerText){_48.StartOffset=_48.EndOffset=_47.innerText.length;}try{_q162(_42.element,_48);}catch(err){}_42.DomTrace();}function ComponentArt_CreateElementWithName(doc,_4a,_4b){if(!_4b){return doc.createElement(_4a);}if(cart_browser_ie){return doc.createElement("<"+_4a+" name=\""+_4b+"\"></"+_4a+">");}else{var _4c=doc.createElement(_4a);_4c.setAttribute("name",_4b);return _4c;}}function ComponentArt_InsertDomElement(_4d,_4e,_4f,_50){if(_4d.parentEditor.get_mode()=="source"){return;}_4d.contentWindow.focus();var _51;if(_50){_51=_50;}else{if(_4d.parentEditor.SelectionBookmark){_51=_4d.parentEditor.SelectionBookmark;_4d.parentEditor.SelectionBookmark=null;}else{_51=_q10F(_4d);}}if(_51.StartOffset==0&&((_51.StartContainer==_51.CommonAncestorContainer)||(_51.CommonAncestorContainer.childNodes&&(_51.StartContainer==_51.CommonAncestorContainer.childNodes[0])))){if((_4e.constructor&&_4e.constructor==Array)||(_4e[0]&&_4e[0].nodeName)){if(_4e.constructor&&_4e.constructor==Array){for(var i=0;i<_4e.length;i++){ComponentArt_InsertBefore(_51.CommonAncestorContainer,_4e[i],(_51.StartContainer.nodeType==3)?_51.StartContainer:_51.StartContainer.firstChild);}_4e=_4e[0];}else{for(var i=_4e.length-1;i>-1;i--){ComponentArt_InsertBefore(_51.CommonAncestorContainer,_4e[i],(_51.StartContainer.nodeType==3)?_51.StartContainer:_51.StartContainer.firstChild);}_4e=_4e[_4e.length-1];}}else{ComponentArt_InsertBefore(_51.CommonAncestorContainer,_4e,(_51.StartContainer.nodeType==3)?_51.StartContainer:_51.StartContainer.firstChild);}return;}var _53=_51.EndContainer.nextSibling;if((_4e.constructor&&_4e.constructor==Array)||(_4e[0]&&_4e[0].nodeName)){if(_4e.constructor&&_4e.constructor==Array){for(var i=0;i<_4e.length;i++){ComponentArt_InsertBefore(_51.StartContainer.parentNode,_4e[i],_51.StartContainer.nextSibling);}_4e=_4e[0];}else{for(var i=_4e.length-1;i>-1;i--){ComponentArt_InsertBefore(_51.StartContainer.parentNode,_4e[i],_51.StartContainer.nextSibling);}_4e=_4e[_4e.length-1];}}else{if(_51.EndContainer.firstChild){ComponentArt_InsertBefore(_51.EndContainer,_4e,(_51.EndContainer.firstChild.nextSibling)?_51.EndContainer.firstChild.nextSibling:null);}else{ComponentArt_InsertBefore(_51.EndContainer.parentNode,_4e,_51.EndContainer.nextSibling);}}var _54=null;if(_51.StartContainer.nodeValue){_54=_4d.contentWindow.document.createTextNode(_51.EndContainer.nodeValue.substring(_51.EndOffset));_51.StartContainer.nodeValue=_51.StartContainer.nodeValue.substring(0,_51.StartOffset);}else{if(_51.StartContainer.innerText){_54=_4d.contentWindow.document.createTextNode(_51.StartContainer.innerText.substring(_51.EndOffset));_51.StartContainer.innerText=_51.StartContainer.innerText.substring(0,_51.StartOffset);}else{if(_51.StartContainer.firstChild.nodeValue){var _54=_4d.contentWindow.document.createTextNode(_51.EndContainer.firstChild.nodeValue.substring(_51.EndOffset));_51.StartContainer.firstChild.nodeValue=_51.StartContainer.firstChild.nodeValue.substring(0,_51.StartOffset);}}}if(_54){if(cart_browser_ie){ComponentArt_InsertBefore(_51.CommonAncestorContainer,_54,_53);}else{if(_51.EndContainer.nodeType!=3){ComponentArt_InsertBefore(_51.EndContainer,_54,_4e.nextSibling);}else{ComponentArt_InsertBefore(_4e.parentNode,_54,_4e.nextSibling);}}}if(!_4f){return _4e;}if(_4f){var _55=0;if(ComponentArt_IsSelectionEmpty(_51)){_55++;}var _51=new Object();_51.CommonAncestorContainer=_51.CommonAncestorContainer;_51.EndContainer=_51.StartContainer=_4f;_51.StartOffset=(_4f.nodeType==3)?_4f.nodeValue.length:0;_51.EndOffset=(_4f.nodeType==3)?_4f.nodeValue.length:0+_55;try{_q162(_4d,_51);}catch(err){}}return _4e;}function ComponentArt_SplitDomElement(_56,_57){var _58=(_56.parentEditor.SelectionBookmark)?_56.parentEditor.SelectionBookmark:_q10F(_56);_56.parentEditor.SelectionBookmark=null;var _59=ComponentArt_LocateSelection(_57,_58);if(_59==0){if(_57.nodeName.length==2&&_57.nodeName.substring(0,1)=="H"){var _5a=_56.contentWindow.document.createElement("DIV");}else{var _5a=_57.cloneNode(false);}if(_5a.nodeName=="DIV"){_5a.innerHTML="&nbsp;";}ComponentArt_InsertBefore(_57.parentNode,_5a,_57);ComponentArt_FocusElement(_56,_57);return _5a;}if(_59==1){if(_57.nodeName!="H1"&&_57.nodeName!="H2"&&_57.nodeName!="H3"&&_57.nodeName!="H4"){var _5a=_57.cloneNode(false);_5a.innerHTML="&nbsp;";ComponentArt_InsertBefore(_57.parentNode,_5a,_57.nextSibling);}else{var _5a=_56.contentWindow.document.createElement("DIV");_5a.innerHTML="&nbsp;";ComponentArt_InsertBefore(_57.parentNode,_5a,_57.nextSibling);}ComponentArt_FocusElement(_56,_5a);return _5a;}if(_59==2){var _5a=_57.cloneNode(false);if(_58.StartContainer.nodeType!=3){_58.StartContainer=_58.StartContainer.childNodes[0];}if(_58.StartContainer.nodeValue&&_58.EndOffset<_58.StartContainer.nodeValue.length){var _5b=_58.StartContainer.nodeValue.substring(_58.EndOffset);}if(_58.EndOffset==0){_58.StartContainer.innerHTML="";}else{_58.StartContainer.nodeValue=_58.StartContainer.nodeValue.substring(0,_58.EndOffset);}if(_5b){_5a.appendChild(_56.contentWindow.document.createTextNode(_5b));}else{_5a.innerHTML="&nbsp;";}ComponentArt_InsertBefore(_57.parentNode,_5a,_57.nextSibling);ComponentArt_FocusElement(_56,_5a);return _5a;}var _5c=_56.contentWindow.document.createElement("a");_5c.setAttribute("id","temp_a");ComponentArt_InsertDomElement(_56,_5c,null,_58);var _5a=_57.cloneNode(true);ComponentArt_InsertBefore(_57.parentNode,_5a,_57.nextSibling);if(_58.StartContainer.childNodes.length==1&&_58.StartContainer.childNodes[0].nodeType==3){_58.StartContainer==_58.StartContainer.childNodes[0];}if(_58.StartOffset==0){_58.StartContainer.innerHTML="";}else{if(_58.StartContainer.nodeValue){_58.StartContainer.nodeValue=_58.StartContainer.nodeValue.substring(0,_58.StartOffset);}else{_58.StartContainer.innerHTML=_58.StartContainer.innerHTML.substring(0,_58.StartOffset);}}ComponentArt_RemoveTrailingSiblings(_57,"temp_a",false);if(_5a.childNodes.length>0){var _5d=ComponentArt_RemoveLeadingSiblings(_5a,"temp_a",_58.StartOffset);}var _5e=new Object();_5e.leadingText=0;_5e.trailingText=0;_5e.nodeLength=0;_5e.trailing=false;_5e=ComponentArt_RecurseChildren(_5a,_58,_5e);if(_5e.leadingText+_5e.trailingText==0){_5a.innerHTML+="&nbsp;";var _5d=_5a;}var _58=new Object;_58.StartContainer=_58.EndContainer=_58.CommonAncestorContainer=_5a;if(_5d){_58.StartContainer=_58.EndContainer=_58.CommonAncestorContainer=_5d;}_58.EndOffset=_58.StartOffset=0;try{_q162(_56,_58);}catch(err){}_qF2(_5c);_qF2(_56.parentEditor.document.getElementById("temp_a"));}function ComponentArt_RemoveLeadingSiblings(_5f,_60,_61){flag=false;for(var i=0;i<_5f.childNodes.length;i++){if(_5f.childNodes.length>i+1&&_5f.childNodes[i+1].id==_60){_5f.removeChild(_5f.childNodes[i+1]);flag=true;}if(flag){if(_61>0&&_5f.childNodes[i].nodeValue){_5f.childNodes[i].nodeValue=_5f.childNodes[i].nodeValue.substring(_61);}else{if(_61>0){_5f.childNodes[i].innerHTML=_5f.childNodes[i].innerHTML.substring(_61);}}return _5f;}if(_5f.childNodes[i].childNodes){flag=ComponentArt_RemoveLeadingSiblings(_5f.childNodes[i],_60,_61);}if(flag){return flag;}if(i==0&&_5f.childNodes[i].nodeName=="#text"){_5f.childNodes[i].nodeValue="";}else{_5f.removeChild(_5f.childNodes[i]);i--;}}return false;}function ComponentArt_RemoveTrailingSiblings(_63,_64,_65){for(var i=0;i<_63.childNodes.length;i++){if(_63.childNodes[i].id==_64){_63.removeChild(_63.childNodes[i]);_65=true;i--;}else{if(_65){if(i==0&&_63.childNodes[i].nodeName=="#text"){_63.childNodes[i].nodeValue="";}else{_63.removeChild(_63.childNodes[i]);}i--;}}if(!_65&&_63.childNodes[i].childNodes){_65=ComponentArt_RemoveTrailingSiblings(_63.childNodes[i],_64,_65);}}return _65;}function ComponentArt_RecurseChildren(_67,_68,_69){for(var i=0;i<_67.childNodes.length;i++){var _6b=_67.childNodes[i];var _6c;if(cart_browser_ie){_6c=_6b.nodeType==3?_6b.nodeValue:_6b.innerText;}else{_6c=_6b.nodeType==3?_6b.nodeValue:(_6b.firstChild?_6b.firstChild.nodeValue:"");}if(_6b!=_68.StartContainer){if(cart_browser_ie||_6b.nodeType!=3||_67!=_68.StartContainer){if(_69.trailing){if(_6c.length>0){_69.trailingText+=_6c.length;}}else{if(_6c.length>0){_69.leadingText+=_6c.length;}}}}else{if(_6c.length>0){_69.trailingText+=_6c.length-_68.EndOffset;_69.nodeLength=_6c.length;}_69.trailing=true;}if(_67.childNodes[i].childNodes&&_67.childNodes[i].childNodes.length>0){_69=ComponentArt_RecurseChildren(_67.childNodes[i],_68,_69);}}return _69;}function ComponentArt_LocateSelection(_6d,_6e){var _6f=new Object();_6f.leadingText=_6e.StartOffset;_6f.trailingText=0;_6f.nodeLength=0;_6f.trailing=false;if(_6d==_6e.StartContainer){var _70;if(cart_browser_ie){_70=_6d.nodeType==3?_6d.nodeValue:_6d.innerText;}else{_70=_6d.nodeType==3?_6d.nodeValue:(_6d.firstChild?_6d.firstChild.nodeValue:"");}if(_70.length>0){_6f.trailingText+=_70.length-_6e.EndOffset;_6f.nodeLength=_70.length;}_6f.trailing=true;}_6f=ComponentArt_RecurseChildren(_6d,_6e,_6f);if(_6f.leadingText==0){return 0;}else{if(_6f.trailingText==0){return 1;}else{if(_6f.trailingText+_6f.leadingText==_6f.nodeLength){return 2;}else{return 3;}}}}function ComponentArt_SelectionOffsetsToInfoRecurse(_71,_72,_73){for(var i=0;i<_71.childNodes.length;i++){var _75=_71.childNodes[i];if(_75.nodeType==3){var _76=_73;_73+=_75.nodeValue.length;if(_73>=_72){return {"Node":(_71.firstChild==_75?_71:_75),"Offset":(_72-_76),"Complete":true};}}else{if(_75.childNodes.length){var ret=ComponentArt_SelectionOffsetsToInfoRecurse(_75,_72,_73);if(ret.Complete){return ret;}else{_73=ret.Offset;}}}}return {"Offset":_73};}function ComponentArt_SelectionOffsetsToInfo(_78,_79){var _7a=_78.contentWindow.document.body;var _7b=ComponentArt_SelectionOffsetsToInfoRecurse(_7a,_79.StartOffset,0);var _7c=ComponentArt_SelectionOffsetsToInfoRecurse(_7a,_79.EndOffset,0);return {"CommonAncestorContainer":_7a,"StartContainer":_7b.Node,"StartOffset":_7b.Offset,"EndContainer":_7c.Node,"EndOffset":_7c.Offset};}function ComponentArt_ScrollSelectionIntoView(_7d,_7e){var o=_7e.StartContainer;var _80=0;while(o&&o!=_7d.contentWindow.document.body){_80+=o.offsetTop;o=o.offsetParent;}_7d.contentWindow.document.body.scrollTop=_80;}function ComponentArt_IsWordMatch(_81,_82,_83){var _84="1234567890abcdefghijklmnopqrstuvwxyz";if((_83==0||_84.indexOf(_81.charAt(_83-1).toLowerCase())<0)&&(_83+_82.length>=_81.length||_84.indexOf(_81.charAt(_83+_82.length).toLowerCase())<0)){return true;}return false;}function ComponentArt_Find(_85,_86,_87,_88,_89){var _8a=_85.contentWindow.document.body;var _8b=_8a.innerText?_8a.innerText.replace(/\r\n|\r|\n/g,""):_8a.textContent;if(_87){_8b=_8b.toLowerCase();_86=_86.toLowerCase();}var _8c=_8b.indexOf(_86);while(_88&&_8c>=0&&!ComponentArt_IsWordMatch(_8b,_86,_8c)){_8c=_8b.indexOf(_86,_8c+1);}if(_8c<0){return null;}if(_89){for(var i=0;i<_89&&_8c>=0;i++){_8c=_8b.indexOf(_86,_8c+1);while(_88&&_8c>=0&&!ComponentArt_IsWordMatch(_8b,_86,_8c)){_8c=_8b.indexOf(_86,_8c+1);}}}if(_8c>=0){return ComponentArt_SelectionOffsetsToInfo(_85,{"StartOffset":_8c,"EndOffset":(_8c+_86.length)});}return null;}function ComponentArt_Replace(_8e,_8f){if(_8e.StartContainer==_8e.EndContainer){var _90=_8e.StartContainer.nodeType==3?_8e.StartContainer:_8e.StartContainer.firstChild;if(_90.nodeType==3){_90.nodeValue=_90.nodeValue.substring(0,_8e.StartOffset)+_8f+_90.nodeValue.substring(_8e.EndOffset);}}else{}}function ComponentArt_SelectionInfoToPaths(_91){var _92=[];if(!_91||!_91.StartContainer){return;}for(var _93=_91.StartContainer;_93.nodeName!="BODY";_93=_93.parentNode){for(var i=0;i<_93.parentNode.childNodes.length;i++){if(_93.parentNode.childNodes[i]==_93){_92[_92.length]=i;break;}}}var _95=[];for(var _93=_91.EndContainer;_93.nodeName!="BODY";_93=_93.parentNode){for(var i=0;i<_93.parentNode.childNodes.length;i++){if(_93.parentNode.childNodes[i]==_93){_95[_95.length]=i;break;}}}var _96=(_91.EndOffset>0)?-1:0;return {"StartPath":(_92.reverse().join(",")+":"+_91.StartOffset),"EndPath":(_95.reverse().join(",")+":"+(_91.EndOffset+_96))};}function ComponentArt_SelectionPathsToInfo(_97,_98){var _99={"CommonAncestorContainer":_97.contentWindow.document.body};var _9a=_98.StartPath.split(":");var _9b=_9a[0].split(",");var _9c=_99.CommonAncestorContainer;for(var i=0;i<_9b.length;i++){if(i==_9b.length-1&&_9b[i]=="0"&&_9c.firstChild.nodeType==3){break;}_9c=_9c.childNodes[parseInt(_9b[i])];}_99.StartContainer=_9c;_99.StartOffset=parseInt(_9a[1]);var _9e=_98.EndPath.split(":");var _9f=_9e[0].split(",");var _9c=_99.CommonAncestorContainer;for(var i=0;i<_9f.length;i++){if(i==_9f.length-1&&_9f[i]=="0"&&_9c.firstChild.nodeType==3){break;}_9c=_9c.childNodes[parseInt(_9f[i])];}_99.EndContainer=_9c;_99.EndOffset=parseInt(_9e[1]);return _99;}function ComponentArt_ClearSelection(_a0){var doc=_a0.contentWindow.document;var _a2="";if(cart_browser_ie){_a0.parentEditor.Focus();var _a3=doc.selection.createRange();_a2=_a3.text;doc.selection.clear();doc.selection.empty();}else{var _a4;if(_a0.contentWindow.getSelection){_a4=_a0.contentWindow.getSelection();}else{if(doc.selection){_a4=doc.selection.createRange();}}var _a3;if(_a4.getRangeAt){_a3=_a4.getRangeAt(0);}else{_a3=doc.createRange();_a3.setStart(_a4.anchorNode,_a4.anchorOffset);_a3.setEnd(_a4.focusNode,_a4.focusOffset);}_a2=_a3.toString();_a3.deleteContents();_a0.contentWindow.getSelection().removeAllRanges();}_a0.parentEditor.Focus();return _a2;}function ComponentArt_IsSelectionEmpty(_a5){return (_a5.StartContainer==_a5.EndContainer&&_a5.StartOffset==_a5.EndOffset);}function ComponentArt_IsSelectionComplete(_a6){var _a7=_a6.EndContainer.nodeValue?_a6.EndContainer.nodeValue:_a6.EndContainer.innerHTML;return (_a6.StartOffset==0&&_a6.EndOffset==_a7.length);}function _qE0(_a8,_a9,_aa,_ab){var _ac=_aa.innerText;for(var i=0;i<_aa.childNodes.length;i++){var _ae=_aa.childNodes[i];var _af=_ae.nodeType==3?_ae.nodeValue:_ae.innerText;if(_af.length>0){var _b0=_ac.indexOf(_af,_ab);if(_b0>0){_ab=_b0;}}var _b1=_ab;_ab+=_af.length;if((_a9&&_b1<_a8.StartOffset&&_ab>=_a8.StartOffset)||(!_a9&&_b1<_a8.EndOffset&&_ab>=_a8.EndOffset)){if(_ae.childNodes.length){_qE0(_a8,_a9,_ae,_b1);return;}else{if(_a9){_a8.StartContainer=_ae;_a8.StartOffset-=_b1;}else{_a8.EndContainer=_ae;_a8.EndOffset-=_b1;}}return;}}}function ComponentArt_IsAncestorOf(_b2,_b3){while(_b3){if(_b3==_b2){return true;}_b3=_b3.parentNode;}return false;}function _qDF(_b4){while(_b4.CommonAncestorContainer&&!ComponentArt_IsAncestorOf(_b4.CommonAncestorContainer,_b4.StartContainer)){_b4.CommonAncestorContainer=_b4.CommonAncestorContainer.parentNode;}while(_b4.CommonAncestorContainer&&!ComponentArt_IsAncestorOf(_b4.CommonAncestorContainer,_b4.EndContainer)){_b4.CommonAncestorContainer=_b4.CommonAncestorContainer.parentNode;}}function _q111(_b5){_b5.parentEditor.Focus();var doc=_b5.contentWindow.document;var _b7=new Object();var _b8=doc.selection.createRange();if(!_b8.duplicate){return;}var _b9=_b8.duplicate();var _ba=_b8.duplicate();_b9.collapse(true);_ba.collapse(false);_b7.StartContainer=_b9.parentElement();_b7.EndContainer=_ba.parentElement();_b9.moveToElementText(_b7.StartContainer);_ba.moveToElementText(_b7.EndContainer);_b9.setEndPoint("EndToEnd",_b8);_b7.StartOffset=_b9.text.length-_b8.text.length;_b8.setEndPoint("StartToStart",_ba);_b7.EndOffset=_b8.text.length;_b7.CommonAncestorContainer=_b8.parentElement();_qDF(_b7);_qE0(_b7,1,_b7.StartContainer,0);_qE0(_b7,0,_b7.EndContainer,0);if(_b7.StartContainer.childNodes.length==1&&_b7.StartContainer.firstChild==_b7.EndContainer&&_b7.EndContainer.nodeType==3){_b7.EndContainer=_b7.StartContainer;}if(_b7.EndContainer.childNodes.length==1&&_b7.EndContainer.firstChild==_b7.StartContainer&&_b7.StartContainer.nodeType==3){_b7.StartContainer=_b7.EndContainer;}return _b7;}function _q112(_bb){var doc=_bb.contentWindow.document;var _bd=new Object();var _be;if(_bb.contentWindow.getSelection){_be=_bb.contentWindow.getSelection();}else{if(doc.selection){_be=doc.selection.createRange();}}var _bf;if(_be.getRangeAt){_bf=_be.getRangeAt(0);}else{_bf=doc.createRange();_bf.setStart(_be.anchorNode,_be.anchorOffset);_bf.setEnd(_be.focusNode,_be.focusOffset);}_bd.StartContainer=_bf.startContainer;_bd.StartOffset=_bf.startOffset;_bd.EndContainer=_bf.endContainer;_bd.EndOffset=_bf.endOffset;_bd.CommonAncestorContainer=_bf.commonAncestorContainer;if(_bd.StartContainer.nodeType!=3){_bd.StartOffset=0;}if(_bd.EndContainer.nodeType!=3&&_bd.EndContainer.firstChild.nodeValue){_bd.EndOffset=_bd.EndContainer.firstChild.nodeValue.length;}if(_bd.StartContainer.nodeType==3&&_bd.StartContainer.parentNode&&_bd.StartContainer.parentNode.childNodes.length==1){_bd.StartContainer=_bd.StartContainer.parentNode;}if(_bd.EndContainer.nodeType==3&&_bd.EndContainer.parentNode&&_bd.EndContainer.parentNode.childNodes.length==1){_bd.EndContainer=_bd.EndContainer.parentNode;}if(_bd.EndContainer==_bd.StartContainer){_bd.CommonAncestorContainer=_bd.StartContainer;}return _bd;}function _q10F(_c0){if(cart_browser_ie){return _q111(_c0);}else{return _q112(_c0);}}function _q162(_c1,_c2,_c3){var doc=_c1.contentWindow.document;if(cart_browser_ie){if(_c2.StartContainer.childNodes&&_c2.StartContainer.childNodes.length==1&&_c2.StartContainer.firstChild==_c2.EndContainer&&_c2.EndContainer.nodeType==3){_c2.EndContainer=_c2.StartContainer;}if(_c2.EndContainer.childNodes&&_c2.EndContainer.childNodes.length==1&&_c2.EndContainer.firstChild==_c2.StartContainer&&_c2.StartContainer.nodeType==3){_c2.StartContainer=_c2.EndContainer;}var _c5=doc.body.createTextRange();if(_c2.StartContainer==_c2.EndContainer){if(_c2.StartContainer==_c2.EndContainer&&_c2.StartContainer.nodeType==3){var _c6=0;var _c7=_c2.CommonAncestorContainer;for(var i=0;i<_c2.CommonAncestorContainer.childNodes.length;i++){var _c9=_c2.CommonAncestorContainer.childNodes[i];if(_c9==_c2.StartContainer){break;}else{var _ca=_c9.nodeType==3?_c9.nodeValue:_c9.innerText;if(_ca){_c6+=_ca.length;}}}_c2.StartContainer=_c2.EndContainer=_c7;_c2.StartOffset+=_c6;_c2.EndOffset+=_c6;}var _cb=_c2.StartContainer;_c5.moveToElementText(_cb);if(_c2.StartOffset>0){_c5.moveStart("character",_c2.StartOffset);}else{_c5.moveStart("character",1);_c5.moveStart("character",-1);}if(_c2.StartOffset==_c2.EndOffset){_c5.collapse(true);}else{var _cc=_cb.nodeType==3?_cb.nodeValue.length:_cb.innerText.replace(/\r\n|\r|\n/g,"").length;_c5.moveEnd("character",_c2.EndOffset-_cc);}}else{if(_c3){_c5=doc.selection.createRange();}if(!_c3||_c3.StartContainer!=_c2.StartContainer){var _cd=doc.body.createTextRange();_cd.moveToElementText(_c2.StartContainer);if(_c2.StartOffset>0){_cd.moveStart("character",_c2.StartOffset);}_c5.setEndPoint("StartToStart",_cd);}if(!_c3||_c3.EndContainer!=_c2.EndContainer){try{var _ce=doc.body.createTextRange();_ce.moveToElementText(_c2.EndContainer);var _ca=_c2.EndContainer.nodeType==3?_c2.EndContainer.nodeValue:_c2.EndContainer.innerText;_ce.moveEnd("character",_c2.EndOffset-_ca.length);_c5.setEndPoint("EndToEnd",_ce);}catch(ex){}}}_c5.select();}else{var _c5=doc.createRange();if(_c2.StartContainer==_c2.EndContainer){var _cb=_c2.StartContainer.childNodes.length>0&&_c2.StartContainer.firstChild.nodeType==3?_c2.StartContainer.firstChild:_c2.StartContainer;if(_c2.EndOffset==_c2.StartOffset){_c5.setStart(_cb,_c2.StartOffset);_c5.collapse(true);}else{_c5.selectNodeContents(_c2.StartContainer);try{_c5.setStart(_cb,_c2.StartOffset);_c5.setEnd(_cb,_c2.EndOffset);}catch(ex){}}}else{_c5.setStartBefore(_c2.StartContainer);_c5.setEndAfter(_c2.EndContainer);try{var _cf=_c2.StartContainer.childNodes.length>0&&_c2.StartContainer.firstChild.nodeType==3?_c2.StartContainer.firstChild:_c2.StartContainer;_c5.setStart(_cf,_c2.StartOffset);var _d0=_c2.EndContainer.childNodes.length>0&&_c2.EndContainer.firstChild.nodeType==3?_c2.EndContainer.firstChild:_c2.EndContainer;_c5.setEnd(_d0,_c2.EndOffset);}catch(ex){}}var _d1;if(_c1.contentWindow.getSelection){_d1=_c1.contentWindow.getSelection();}else{if(doc.selection){_d1=doc.selection.createRange();}}_d1.removeAllRanges();_d1.addRange(_c5);}}function _qE1(_d2,_d3){var _d4=!(_d3.Element=="span");var _d5={"LI":1,"TD":1,"SPAN":1,"DIV":1,"FONT":1};var _d6=_d2.StartContainer;var _d7=false;var _d8=_q104(_d3.StyleString);do{if(_d6==_d2.EndContainer||(_d6.childNodes.length==1&&_d6.firstChild==_d2.EndContainer)){_d7=true;}if(_d6.childNodes.length==1&&_d6.firstChild.nodeType==3&&_d6.style&&_d5[_d6.nodeName]){for(var key in _d8){_d6.style[key]=_d8[key];}}else{if(_d6.nodeType==3){var _da=_d6.nodeValue.replace(/^\s+|\s+$/g,"");if(_da){var _db=_d6.ownerDocument.createElement(_d3.Element);_db.innerHTML=_d6.nodeValue;for(var key in _d8){_db.style[key]=_d8[key];}_d6.parentNode.replaceChild(_db,_d6);_d6=_db;}}}if(!_d7){if(_d6.childNodes.length&&!(_d6.firstChild==_d6.lastChild&&_d6.firstChild.nodeType==3)){_d6=_d6.childNodes[0];}else{if(_d6.nextSibling){_d6=_d6.nextSibling;}else{while(_d6&&!_d6.nextSibling){_d6=_d6.parentNode;}if(_d6){_d6=_d6.nextSibling;}}}}}while(_d6&&!_d7);}function _q163(_dc,_dd,_de){var doc=_dc.contentWindow.document;var _e0=_de.Element&&_de.Element!="SPAN";var _e1=_e0?_de.Element:"SPAN";if(!_dd){_dd=_q10F(_dc);}var _e2=new Object();for(i in _dd){_e2[i]=_dd[i];}if(_dd.StartContainer==_dd.EndContainer){if(ComponentArt_IsSelectionEmpty(_dd)){if(_e0){var _e3={"H1":1,"H2":1,"H3":1,"H4":1};if(_e3[_e1]){_de.ReplaceParagraphTag=true;}var _e4=_dd.CommonAncestorContainer;if(_de.ReplaceParagraphTag){var _e5={"P":1,"LI":1,"TD":1,"DIV":1,"H1":1,"H2":1,"H3":1,"H4":1};while(!_e5[_e4.tagName]&&_e4.parentNode){_e4=_e4.parentNode;}var _e6=doc.createElement(_e1);_e6.innerHTML=_e4.innerHTML;_e4.parentNode.replaceChild(_e6,_e4);_dd.StartContainer=_dd.EndContainer=_dd.CommonAncestorContainer=_e6;}else{var _e7=doc.createElement(_e1);_e7.innerHTML=_e4.innerHTML;_e4.innerHTML="";_e4.appendChild(_e7);_dd.StartContainer=_dd.EndContainer=_dd.CommonAncestorContainer=_e7;}}}else{if(ComponentArt_IsSelectionComplete(_dd)){var _e8={"LI":1,"TD":1,"SPAN":1,"DIV":1,"FONT":1};if(!_e8[_dd.StartContainer.nodeName]){if(_dd.StartContainer.nodeType==3){}else{var _e9=_dd.StartContainer.innerHTML;_dd.StartContainer.innerHTML="<span></span>";_dd.StartContainer=_dd.EndContainer=_dd.StartContainer.firstChild;_dd.StartContainer.innerHTML=_e9;}}}else{var _ea=_dd.StartContainer;var _eb=_ea.parentNode;while(_ea.nodeName!="#text"&&_ea.childNodes){_eb=_ea;_ea=_ea.firstChild;}var _ec=_ea.nodeValue;var _ed=_dd.EndOffset<_ec.length?_ec.substring(_dd.EndOffset):"";if(_ec.length>_dd.StartOffset){_ea.nodeValue=_ec.substring(0,_dd.StartOffset);var _ee=doc.createElement(_e1);_ee.appendChild(doc.createTextNode(_ec.substring(_dd.StartOffset,_dd.EndOffset)));ComponentArt_InsertBefore(_eb,_ee,_ea.nextSibling);_dd.EndOffset=_dd.EndOffset-_dd.StartOffset;_dd.StartContainer=_dd.EndContainer=_ee;_dd.StartOffset=0;}if(_ed){var _ef=doc.createTextNode(_ed);ComponentArt_InsertBefore(_eb,_ef,_ee.nextSibling);}}}}else{var _f0=_dd.StartContainer;if(_dd.StartOffset>0){while(_f0.nodeName!="#text"&&_f0.childNodes){_f0=_f0.firstChild;}var _ec=_f0.nodeValue;if(_ec.length>_dd.StartOffset){_f0.nodeValue=_ec.substring(0,_dd.StartOffset);var _ee=doc.createElement(_e1);_ee.appendChild(doc.createTextNode(_ec.substring(_dd.StartOffset)));ComponentArt_InsertBefore(_f0.parentNode,_ee,_f0.nextSibling);if(_dd.EndOffset==0&&_ee.nextSibling==_dd.EndContainer){_dd.EndContainer=_ee;_dd.EndOffset=_ec.length;}_dd.StartContainer=_ee;_dd.StartOffset=0;}else{if(_dd.StartContainer.nextSibling){_dd.StartContainer=_dd.StartContainer.nextSibling;_dd.StartOffset=0;}}}if(_dd.EndOffset>0){var _f1=_dd.EndContainer;while(_f1.nodeName!="#text"&&_f1.childNodes){_f1=_f1.firstChild;}var _ec=_f1.nodeValue;if(_dd.EndOffset<_ec.length){_f1.nodeValue=_ec.substring(_dd.EndOffset);var _ee=doc.createElement(_e1);_ee.appendChild(doc.createTextNode(_ec.substring(0,_dd.EndOffset)));ComponentArt_InsertBefore(_f1.parentNode,_ee,_f1);if(_dd.StartContainer==_dd.EndContainer){_dd.StartContainer=_ee;}_dd.EndContainer=_ee;}}}_qE1(_dd,_de);try{_q162(_dc,_dd,_e2);}catch(err){}}function ComponentArt_DebugSelection(_f2){return "SC:"+_f2.StartContainer.nodeName+"\nEC:"+_f2.EndContainer.nodeName+"\nSO:"+_f2.StartOffset+"\nEO:"+_f2.EndOffset+"\nCA:"+_f2.CommonAncestorContainer.nodeName+"\n";}function _q104(_f3){var _f4={};if(_f3){var _f5=_f3.split(";");for(var i=0;i<_f5.length;i++){var _f7=_f5[i];if(_f7){var _f8=_f7.split(":");var key=_f8[0].replace(/^\s+|\s+$/g,"");var _fa=_f8[1].replace(/^\s+|\s+$/g,"");_f4[cart_editor_css_key[key]]=_fa;}}}return _f4;}function ComponentArt_Editor_MemberCount(_fb){var _fc=0;for(var _fd in _fb){_fc++;}return _fc;}function ComponentArt_Editor_StyleSortCompare(_fe,_ff){if(_ff.Element!=null&&_fe.Element==null){return 1;}if(_ff.Element==null&&_fe.Element!=null){return -1;}if(_ff.CssClass!=null&&_fe.CssClass==null){return 1;}if(_ff.CssClass==null&&_fe.CssClass!=null){return -1;}return _ff.StyleLength-_fe.StyleLength;}function ComponentArt_Editor_StyleIsInEffect(_100,_101){if(_101.Element!=null&&!_100.HasParent(_101.Element)||_101.CssClass!=null&&!_100.HasCssClass(_101.CssClass)){return false;}for(var _102 in _101.Style){if(_100.getStyle(cart_editor_css_key[_102])!=_101.Style[_102]){return false;}}return true;}function ComponentArt_SetAdjustedHeight(_103,_104){if(!_103){return (_104?_104:0);}if(!_104&&_104!=0){_104=_103.offsetHeight;}if(cart_browser_ie&&_103.currentStyle){var _105=_103.currentStyle;if(_105){var _106=0;_106+=isNaN(parseInt(_105.borderTopWidth))?0:parseInt(_105.borderTopWidth);_106+=isNaN(parseInt(_105.borderBottomWidth))?0:parseInt(_105.borderBottomWidth);_106+=isNaN(parseInt(_105.paddingTop))?0:parseInt(_105.paddingTop);_106+=isNaN(parseInt(_105.paddingBottom))?0:parseInt(_105.paddingBottom);_104-=_106;}}else{if(document.defaultView&&document.defaultView.getComputedStyle){var _105=document.defaultView.getComputedStyle(_103,"");if(_105){var _106=0;_106+=_105.getPropertyValue("border-top-width")?parseInt(_105.getPropertyValue("border-top-width")):0;_106+=_105.getPropertyValue("border-bottom-width")?parseInt(_105.getPropertyValue("border-bottom-width")):0;_106+=_105.getPropertyValue("padding-top")?parseInt(_105.getPropertyValue("padding-top")):0;_106+=_105.getPropertyValue("padding-bottom")?parseInt(_105.getPropertyValue("padding-bottom")):0;_104-=_106;}}}if(_104>0){_103.style.height=_104+"px";_103.height=_104+"px";}else{return false;}}function ComponentArt_SetAdjustedWidth(_107,_108){if(!_107){return (_108?_108:0);}if(!_108&&_108!=0){_108=_107.offsetWidth;}if(cart_browser_ie&&_107.currentStyle){var _109=_107.currentStyle;if(_109){var _10a=0;_10a+=isNaN(parseInt(_109.borderLeftWidth))?0:parseInt(_109.borderLeftWidth);_10a+=isNaN(parseInt(_109.borderRightWidth))?0:parseInt(_109.borderRightWidth);_10a+=isNaN(parseInt(_109.paddingLeft))?0:parseInt(_109.paddingLeft);_10a+=isNaN(parseInt(_109.paddingRight))?0:parseInt(_109.paddingRight);_108-=_10a;}}else{if(document.defaultView&&document.defaultView.getComputedStyle){var _109=document.defaultView.getComputedStyle(_107,"");if(_109){var _10a=0;_10a+=_109.getPropertyValue("border-left-width")?parseInt(_109.getPropertyValue("border-left-width")):0;_10a+=_109.getPropertyValue("border-right-width")?parseInt(_109.getPropertyValue("border-right-width")):0;_10a+=_109.getPropertyValue("padding-left")?parseInt(_109.getPropertyValue("padding-left")):0;_10a+=_109.getPropertyValue("padding-right")?parseInt(_109.getPropertyValue("padding-right")):0;_108-=_10a;}}}if(_108>0){_107.style.width=_108+"px";_107.width=_108+"px";}else{return false;}}
