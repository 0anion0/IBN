function ComponentArt_Editor(id){this.DomElementId=id;this.element=this.DomElement=document.getElementById(this.DomElementId+"_IFrame");this.textarea=this.DomElement=document.getElementById(this.DomElementId+"_Textarea");if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Editor.initializeBase(this,[this.element]);this.beginUpdate=function(){this._updating=true;};this.dispose=function(){};this.endUpdate=function(){this._updating=false;this.Render();};this.get_isUpdating=function(){return this._updating;};this.getDescriptor=function(){return _qEF(this.constructor);};}else{this.beginUpdate=function(){this._updating=true;};this.endUpdate=function(){this._updating=false;this.Render();};this.get_isUpdating=function(){return this._updating;};}this.ClientControlId=this.EditorId=id;}ComponentArt_Editor.prototype.PublicProperties=[["EditMode",String,1],["EditEngine",String,1],["Mode",String],["Editing",Boolean],["FocusOnLoad",Boolean],["EditElement",Object],["Document",Object],["UndoStates",Array],["RedoStates",Array],["LastElement",Object],["SelectionBookmark",Object],["HighlightElementCssClass",String],["BreadcrumbClientTemplateId",String],["BreadcrumbCssClass",String],["BreadcrumbSeparator",String],["BreadcrumbArray",Array],["SourceCssClass",String],["DesignCssClass",String],["CssFileURL",String],["ContentHTML",String,1,1],["ContentText",String,1,1],["ClipboardHTML",String,1,1],["ClipboardCleanHTML",String,1,1],["ClipboardText",String,1,1],["WordCount",Number,1,1],["CharacterCount",Number,1,1],["Selection",Object,1,1],["SelectionText",String,1,1],["Template",String],["TabIndex",String],["Depth",Number],["TextLength",Number],["Debug",Boolean],["PreserveRelativePaths",Boolean],["Action",String]];ComponentArt_Editor.prototype.PublicMethods=[["SourceMode"],["DesignMode"],["Focus"],["ApplyTag"],["SetStyle"],["GetStyle"],["ToggleStyle"],["SetAlign"],["GetListContext"],["InsertHyperlink"],["SetIndent"],["PasteHTML"],["CopySelection"],["CutSelection"],["Print"],["TableInsertRow"],["TableInsertColumn"],["TableDeleteRow"],["TableDeleteColumn"],["TableDeleteCell"],["TableMergeCellRight"],["TableMergeCellDown"],["TableSplitCellHorizontal"],["TableSplitCellVertical"],["InsertFormElement"],["ToggleOrderedList"],["ToggleUnorderedList"],["TopParent"],["SetUnorderedListCssClass"],["SetOrderedListCssClass"],["GetTopUnorderedList"],["GetTopOrderedList"],["New"],["Save"],["Edit"],["Update"],["Cancel"],["InsertHTML"],["InsertImage"]];ComponentArt_Editor.prototype.PublicEvents=[["ContextChange"],["ContentUpdate"],["SaveError"],["SaveSuccess"],["Enter"],["Load"]];_qEE(ComponentArt_Editor);window.ComponentArt.Web.UI.Editor=window.ComponentArt_Editor;if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Editor.registerClass("ComponentArt.Web.UI.Editor",Sys.UI.Control);if(Sys.TypeDescriptor){Sys.TypeDescriptor.addType("componentArtWebUI","editor",ComponentArt.Web.UI.Editor);}}ComponentArt_Editor.prototype.InitKeyboard=function(){};ComponentArt_Editor.prototype.Initialize=function(){if(this.EnableViewState){ComponentArt_ClientStateControls[ComponentArt_ClientStateControls.length]=this;}if(this.Template){var _2=this.Template.split("$$");for(var i=1;i<_2.length;i+=2){if(_2[i]=="parent"){_2[i]=this.Id;}else{if(_2[i].indexOf("ToolBars[")>-1){_2[i]="<span id=\""+this.Id+"_t_"+eval("this."+_2[i])+"\">&nbsp;</span>";}else{_2[i]="<span id=\""+this.Id+"_t_"+_2[i]+"\">&nbsp;</span>";}}}var _4=document.getElementById(this.Id+"_Placeholder");_4.innerHTML=_2.join("");ComponentArt_Swap(this.Id+"_t_breadcrumbs",this.Id+"_Breadcrumbs");ComponentArt_Swap(this.Id+"_t_modetabs",this.Id+"_Modes");ComponentArt_Swap(this.Id+"_t_actions",this.Id+"_Actions");if(this.ToolBars&&this.ToolBars.length){for(var x=0;x<this.ToolBars.length;x++){ComponentArt_Swap(this.Id+"_t_"+this.ToolBars[x],this.Id+"_"+this.ToolBars[x]);}}}if(document.forms[0]){this.element.parentNode.removeChild(this.element);document.forms[0].insertBefore(this.element,document.forms[0].firstChild);}else{document.body.insertBefore(this.element,document.body.firstChild);}_q131(this);this.ChildControls=[];this.ContextMetrics={};this.ContextChangedListeners={"Sometimes":[],"Always":[]};this.UndoStates=[];this.RedoStates=[];ComponentArt_Editor_InitializeStyles(this);ComponentArt_Editor_HookUpControls(this);this.document=this.element.contentWindow.document;this.element.parentEditor=this;var _6=document.getElementById(this.Id+"_Textarea");_6.parentNode.removeChild(_6);if(this.get_editMode()=="Default"){var _7=document.createElement("DIV");_7.style.height="100%";_7.style.width="100%";_7.id=this.Id+"_Area";document.body.appendChild(_7);_7.appendChild(document.createTextNode(""));ComponentArt_Swap(this.Id+"_t_editorarea",this.Id+"_Area");_7.appendChild(_6);}else{this.element.parentNode.insertBefore(_6,this.element);}this.element.style.display="";this.document.designMode="on";this.document.contentEditable="true";this.set_editing(false);this.TabIndex=this.element.tabIndex;this.element.tabIndex=-1;this.element.style.position="absolute";this.element.style.top="-10000px";this.element.style.left="-10000px";if(cart_browser_safari){this.document.onkeypress=this.keyPressEvent;this.document.onkeydown=this.keyDownEvent;this.document.onkeyup=this.keyUpEvent;this.document.onclick=this.mouseClickEvent;this.document.onmousemove=this.mouseMoveEvent;this.document.onblur=this.blurEvent;}else{if(cart_browser_ie){this.document.onkeypress=this.keyPressEvent;this.document.onkeydown=this.keyDownEvent;this.document.onkeyup=this.keyUpEvent;this.document.onclick=this.mouseClickEvent;this.document.onmousemove=this.mouseMoveEvent;this.document.onmousedown=this.mouseDownEvent;this.element.attachEvent("onblur",this.blurEvent);document.attachEvent("onmousedown",new Function("e","eval(\""+this.Id+".SaveBookmark();\");"));}else{this.document.addEventListener("keyup",this.keyUpEvent,true);this.document.addEventListener("keydown",this.keyDownEvent,true);this.document.addEventListener("keypress",this.keyPressEvent,true);this.document.addEventListener("click",this.mouseClickEvent,true);setTimeout(this.Id+".document.addEventListener('blur', "+this.Id+".blurEvent, true);",5000);}}this.SetEditable();this.InitAlign();this.Initialized=true;var _8=this.get_events().getHandler("load");if(_8){_8(this,Sys.EventArgs.Empty);}this.Render();};ComponentArt_Editor.prototype.SetEditable=function(){if(this.get_editMode()!="Default"){this.set_focusOnLoad(false);return;}var _9=document.getElementById(this.Id+"_Area");if(!ComponentArt_IsVisible(_9.parentNode?_9:_9.parentNode)){if(cart_browser_ie){if(document.forms[0]){this.element.parentNode.removeChild(this.element);document.forms[0].insertBefore(this.element,document.forms[0].firstChild);}else{document.body.insertBefore(this.element,document.body.firstChild);}}this.element.style.top="-10000px";this.element.style.left="-10000px";this.element.style.position="absolute";this.element.tabIndex=-1;if(this.Editing&&cart_browser_ie){ComponentArt_WhiteWash(_9);}window.visible_timeout=null;window.visible_timeout=setTimeout(this.Id+".SetEditable()",100);this.Editing=false;return;}else{var _a=document.getElementById(this.Id+"_Textarea");var x=_q85(_9);var y=_q86(_9);if(x!=0&&y!=0){this.element.style.left=x+"px";this.element.style.top=y+"px";}var _d=ComponentArt_GetAdjustedWidth(_9);var _e=ComponentArt_GetAdjustedHeight(_9);var _f=ComponentArt_GetAdjustedHeight(_a,_a.clientHeight)/_a.rows;this.element.tabIndex=this.TabIndex;if((cart_browser_ie&&_a.style.display!="none")||cart_browser_ie7){if(!cart_browser_ie7){ComponentArt_SetAdjustedWidth(_a,_d-2);}else{ComponentArt_SetAdjustedWidth(_a,_d);}if(Math.floor(_e/_f)>0){if(cart_browser_ie7){_a.rows=Math.floor(_e/_f);}else{if(!cart_browser_ie7&&_a.rows<3){_a.rows=Math.floor(_e/_f);}}}}else{_a.style.height="100%";_a.style.width="100%";}if(cart_browser_ie&&this.element.style.position=="absolute"&&this.get_mode()=="design"){this.element.parentNode.removeChild(this.element);_9.insertBefore(this.element,_9.firstChild);if(!cart_browser_ie7){_a.style.display="none";}this.element.style.position="";this.element.style.top="";this.element.style.left="";this.element.style.height="100%";this.element.style.width="100%";}else{if(ComponentArt_GetAdjustedWidth(this.element)!=_d){ComponentArt_SetAdjustedWidth(this.element,_d);}if(ComponentArt_GetAdjustedHeight(this.element)!=_e){ComponentArt_SetAdjustedHeight(this.element,_e);}}window.visible_timeout=null;window.visible_timeout=setTimeout(this.Id+".SetEditable()",100);if(this.Editing==true){return;}_a.className=this.SourceCssClass;this.Editing=true;return;}};ComponentArt_Editor.prototype.InitAlign=function(){if(!this.document.body){setTimeout(this.Id+".InitAlign()",100);return;}if(cart_browser_mozilla){this.document.body.spellcheck=false;}this.document.body.className=this.DesignCssClass;ComponentArt_CloneStyles(document,this.document);if(this.ContentHTML){if(this.PreserveRelativePaths){this.document.body.innerHTML=ComponentArt_ReplacePaths(this.ContentHTML);}else{this.document.body.innerHTML=this.ContentHTML;}}else{if(this.ContentText){this.document.body.innerHTML=this.ContentText;}else{this.document.body.innerHTML="<div>&nbsp;</div>";}}if(cart_browser_mozilla){this.document.designMode="off";this.document.designMode="on";}var _10=new Object();_10.CommonAncestorContainer=this.document.body;_10.EndContainer=_10.StartContainer=this.document.body.firstChild;_10.StartOffset=0;_10.EndOffset=0;this.UpdateCounts();try{_q162(this.element,_10);}catch(err){}document.getElementById(this.Id+"_Textarea").value=ComponentArt_SerializeDomElements(this.document.body.childNodes);this.DomTrace();if(this.FocusOnLoad){this.Focus();}};ComponentArt_Editor.prototype.Print=function(){this.Focus();this.element.contentWindow.print();};ComponentArt_Editor.prototype.insertHTML=function(_11){var _12=_q10F(this.element);if(!ComponentArt_IsSelectionEmpty(_12)){ComponentArt_ClearSelection(this.element);}var _13=this.document.createElement("DIV");_13.innerHTML=_11;if(_13.childNodes.length>0){ComponentArt_InsertDomElement(this.element,_13.childNodes);}_qF2(_13);_12.EndOffset=_12.StartOffset;_q162(this.element,_12);};ComponentArt_Editor.prototype.get_clipboardHTML=function(){var _14=document.getElementById("dumpster");if(!_14){_14=document.createElement("DIV");_14.setAttribute("contentEditable",true);_14.style.position="absolute";_14.style.overflow="hidden";_14.style.top="-1000px";_14.style.left="-1000px";_14.style.width="1px";_14.style.height="1px";_14.style.zIndex="-1000";document.body.appendChild(_14);}_14.innerHTML="";this.SaveBookmark();_14.focus();document.execCommand("Paste",null);_q162(this.element,this.get_selectionBookmark());this.Focus();var _15=_14.innerHTML;_qF2(_14);return _15;};ComponentArt_Editor.prototype.get_clipboardCleanHTML=function(){var _16=document.getElementById("dumpster");if(!_16){_16=document.createElement("DIV");_16.setAttribute("contentEditable",true);_16.style.position="absolute";_16.style.overflow="hidden";_16.style.top="-1000px";_16.style.left="-1000px";_16.style.width="1px";_16.style.height="1px";_16.style.zIndex="-1000";document.body.appendChild(_16);}_16.innerHTML="";if(!this.SelectionBookmark){this.SaveBookmarks();}_16.focus();document.execCommand("Paste",null);_q162(this.element,this.SelectionBookmark);this.SelectionBookmark=this.SelectionBookmarkPaths=null;this.Focus();var _17=ComponentArt_SerializeDomElements(_16.childNodes);_qF2(_16);return _17;};ComponentArt_Editor.prototype.get_clipboardText=function(){var _18=document.getElementById("disposal");if(!_18){_18=ComponentArt_CreateElementWithName(document,"DIV","disposal");_18.setAttribute("contentEditable",true);_18.setAttribute("id","disposal");_18.style.position="absolute";_18.style.overflow="hidden";_18.style.top="-1000px";_18.style.left="-1000px";_18.style.width="1px";_18.style.height="1px";_18.style.zIndex="-1000";document.body.appendChild(_18);}_18.innerHTML="";_18.focus();document.execCommand("Paste",null);_q162(this.element,this.SelectionBookmark);this.SelectionBookmark=this.SelectionBookmarkPaths=null;this.Focus();var _19=(cart_browser_ie)?_18.innerText:_18.textContent;_qF2(_18);return _19;};ComponentArt_Editor.prototype.CopySelection=function(){if(!cart_browser_ie){alert("Please use Control C to copy content.");return;}this.SaveUndo("Copy");if(cart_browser_ie){document.execCommand("Copy",null);}};ComponentArt_Editor.prototype.CutSelection=function(){if(!cart_browser_ie){alert("Please use Control X to cut content.");return;}this.SaveUndo("Cut");if(cart_browser_ie){document.execCommand("Cut",null);}if(this.SelectionBookmark){this.SelectionBookmark.EndOffset=this.SelectionBookmark.StartOffset;this.SelectionBookmark.EndContainer=this.SelectionBookmark.StartContainer;}};ComponentArt_Editor.prototype.PasteHTML=function(_1a){if(!cart_browser_ie){alert("Please use Control V to paste content.");return;}this.SaveUndo("Paste");if(cart_browser_ie){var _1b;if(_1a){_1b=this.get_clipboardCleanHTML();var _1c=this.document.selection.createRange();_1c.pasteHTML(_1b);if(_1c.parentElement.normalize){_1c.parentElement.normalize();}}else{this.document.execCommand("Paste",null);}}else{this.document.execCommand("Paste",null);}};ComponentArt_Editor.prototype.get_characterCount=function(){var _1d=(cart_browser_ie)?this.document.body.innerText.replace(/\r\n|\r|\n/g,"").length:this.document.body.textContent.replace(/\r\n|\r|\n/g,"").length;if(_1d==0&&this.LastElement&&this.LastElement.nodeName!="TD"){this.document.body.innerHTML="<DIV></DIV>";ComponentArt_FocusElement(this.element,this.document.body.firstChild);}return _1d;};ComponentArt_Editor.prototype.get_wordCount=function(){if(this.get_characterCount()==0){return 0;}return (cart_browser_ie)?this.document.body.innerText.split(" ").length:this.document.body.textContent.split(" ").length;};ComponentArt_Editor.prototype.get_contentText=function(){return (cart_browser_ie)?this.document.body.innerText:this.document.body.textContent;};ComponentArt_Editor.prototype.set_contentText=function(_1e){this.document.body.innerHTML=_1e;if(cart_browser_mozilla){this.document.designMode="off";this.document.designMode="on";}this.DomTrace();};ComponentArt_Editor.prototype.set_contentHTML=function(_1f){this.document.body.innerHTML=_1f;if(cart_browser_mozilla){this.document.designMode="off";this.document.designMode="on";}this.DomTrace();};ComponentArt_Editor.prototype.get_contentHTML=function(_20){return ComponentArt_SerializeDomElements(this.document.body.childNodes);};ComponentArt_Editor.prototype.New=function(){this.DesignMode();this.document.body.innerHTML="<div>&nbsp;</div>";};ComponentArt_Editor.prototype.GetProperty=function(_21){return this[_21];};ComponentArt_Editor.prototype.SetProperty=function(_22,_23){this[_22]=_23;};ComponentArt_Editor.prototype.Render=function(){};ComponentArt_Editor.prototype.UpdateCounts=function(){var _24=document.getElementById(this.Id+"_t_wordcount");var _25=document.getElementById(this.Id+"_t_charactercount");if(_24){_24.innerHTML=this.get_wordCount();}if(_25){_25.innerHTML=this.get_characterCount();}};ComponentArt_Editor.prototype.UpdateBreadcrumbs=function(){var _26=document.getElementById(this.Id+"_Breadcrumbs");this.BreadcrumbArray=new Array();if(!this.GetClientTemplate(this.BreadcrumbClientTemplateId)&&this.ClientTemplates.length>0){this.BreadcrumbClientTemplateId=this.ClientTemplates[0][0];}if(_26&&this.LastElement){var _27=this.LastElement;var _28="";var _29=0;while(_27&&_27.nodeName&&_27.nodeName!="BODY"){if(_27.nodeType!=3){var _2a=new Object();_2a.breadcrumb=_27.nodeName;this.BreadcrumbArray[this.BreadcrumbArray.length]=_27;var _2b=ComponentArt_InstantiateClientTemplate(this.GetClientTemplate(this.BreadcrumbClientTemplateId),this,_2a);var _2c=(_29>0)?this.BreadcrumbSeparator+_28:_28;_28="<div onclick=\"ComponentArt_SelectElement("+this.Id+".element,"+this.Id+".BreadcrumbArray["+_29+"]);\" onmouseout=\""+this.Id+".BreadcrumbArray["+_29+"].className = "+this.Id+".BreadcrumbArray["+_29+"].className.replace('"+this.HighlightElementCssClass+"','');\" onmouseover=\""+this.Id+".BreadcrumbArray["+_29+"].className += ' "+this.HighlightElementCssClass+"';\" class=\""+this.BreadcrumbCssClass+"\">"+_2b+"</div>"+_2c;_29++;}_27=_27.parentNode;}if(this.get_editMode()=="Default"){var _2a=new Object();_2a.breadcrumb="BODY";this.BreadcrumbArray[this.BreadcrumbArray.length]=this.document.body;var _2b=ComponentArt_InstantiateClientTemplate(this.GetClientTemplate(this.BreadcrumbClientTemplateId),this,_2a);_28="<div onclick=\"ComponentArt_SelectElement("+this.Id+".element,"+this.Id+".BreadcrumbArray["+_29+"]);\" onmouseout=\""+this.Id+".BreadcrumbArray["+_29+"].className = "+this.Id+".BreadcrumbArray["+_29+"].className.replace('"+this.HighlightElementCssClass+"','');\" onmouseover=\""+this.Id+".BreadcrumbArray["+_29+"].className += ' "+this.HighlightElementCssClass+"';\" class=\""+this.BreadcrumbCssClass+"\">"+_2b+"</div>"+this.BreadcrumbSeparator+_28;}this.Depth=_29;_26.innerHTML=_28;}};ComponentArt_Editor.prototype.UpdateActions=function(){return false;var _2d=document.getElementById(this.Id+"_Actions");var _2e="";for(i=0;i<this.UndoStates.length;i++){_2e+=this.UndoStates[i].action+" > ";}for(i=this.RedoStates.length-1;i>=0;i--){_2e+=" < "+this.RedoStates[i].action;}_2d.innerHTML=_2e;this.Focus();};ComponentArt_Editor.prototype.DesignMode=function(){if(this.get_mode()=="source"){this.set_mode("design");setTimeout("ComponentArt_EnableDisableChildControls(window."+this.Id+",true);",1);var _2f=document.getElementById(this.Id+"_Textarea");_2f.style.visibility="hidden";_2f.style.display="none";this.element.style.display="";if(this.PreserveRelativePaths){this.document.body.innerHTML=ComponentArt_ReplacePaths(_2f.value);}else{this.document.body.innerHTML=_2f.value;}this.document.body.className=this.DesignCssClass;setTimeout(this.Id+".Focus();"+this.Id+".DomTrace();"+this.Id+".UpdateBreadcrumbs()",50);}};ComponentArt_Editor.prototype.Focus=function(){if(this.get_editing()&&this.element.style.display!="none"&&this.element.style.visibility!="false"&&ComponentArt_IsVisible(this.element)){this.element.contentWindow.focus();}};ComponentArt_Editor.prototype.SourceMode=function(){if(this.get_mode()=="design"&&this.get_editing()){this.set_mode("source");setTimeout("ComponentArt_EnableDisableChildControls(window."+this.Id+",false);",1);var _30=document.getElementById(this.Id+"_Textarea");_30.className=this.SourceCssClass;if(cart_browser_mozilla){_30.spellcheck=false;}if(this.get_editMode()!="Default"){var _31=cart_browser_ie?0:-2;var _32=cart_browser_ie?-2:0;_30.style.left=_q85(this.element)+"px";_30.style.top=_q86(this.element)+"px";var _33=(ComponentArt_GetAdjustedWidth(this.element)+_32);var _34=(ComponentArt_GetAdjustedHeight(this.element)+_31);}_30.value=ComponentArt_SerializeDomElements(this.document.body.childNodes);_30.style.visibility="";_30.style.display="";this.element.style.display="none";if(this.get_editMode()!="Default"){ComponentArt_SetAdjustedWidth(_30,_33);ComponentArt_SetAdjustedHeight(_30,_34);}_30.focus();var _35=document.getElementById(this.Id+"_Breadcrumbs");if(_35){var _36=new Object();_36.breadcrumb="N/A";var _37=ComponentArt_InstantiateClientTemplate(this.GetClientTemplate(this.BreadcrumbClientTemplateId),this,_36);output=_37;if(_35){_35.innerHTML=output;}}}};ComponentArt_Editor.prototype.Edit=function(_38){if(this.get_editMode()=="Default"){return;}this.DesignMode();if(this.get_editElement()){this.EditElement.style.visibility="visible";}var x=_q85(_38);var y=_q86(_38);var _3b=_38.offsetWidth;var _3c=_38.offsetHeight;this.element.style.left=x+"px";this.element.style.top=y+"px";ComponentArt_SetAdjustedWidth(this.element,_3b);ComponentArt_SetAdjustedHeight(this.element,_3c);this.element.style.display="";if(_38.innerHTML||_38.nodeValue){this.document.body.innerHTML=(_38.innerHTML)?_38.innerHTML:_38.nodeValue;}_38.style.visibility="hidden";this.set_editing(true);this.set_editElement(_38);this.Focus();};ComponentArt_Editor.prototype.Update=function(){if(this.get_editMode()=="Default"){return;}this.DesignMode();var _3d=this.get_contentHTML();if(this.get_editElement().innerHTML){this.EditElement.innerHTML=_3d;}else{this.EditElement.nodeValue=_3d;}this.EditElement.style.visibility="visible";this.set_editing(false);this.set_editElement(null);this.element.style.display="none";var _3e=this.get_events().getHandler("contentUpdate");if(_3e){_3e(this,Sys.EventArgs.Empty);}};ComponentArt_Editor.prototype.Cancel=function(){if(this.get_editMode()=="Default"){return;}this.DesignMode();this.EditElement.style.visibility="visible";this.set_editing(false);this.set_editElement(null);this.element.style.display="none";};ComponentArt_Editor.prototype.CntrlCommand=function(_3f,_40){switch(_3f){case "b":this.SetStyle("font-weight",(this.getStyle("font-weight")=="700")?"":"700");ComponentArt_CancelEvent(_40);return false;break;case "i":this.SetStyle("font-style",(this.getStyle("font-style")=="italic")?"":"italic");ComponentArt_CancelEvent(_40);return false;break;case "u":this.SetStyle("text-decoration",(this.getStyle("text-decoration")=="underline")?"":"underline");ComponentArt_CancelEvent(_40);return false;break;case "v":if(cart_browser_ie){this.SelectionBookmark=this.SelectionBookmarkPaths=null;this.SaveBookmark();this.PasteHTML(true);ComponentArt_CancelEvent(_40);}else{this.SaveUndo("Paste");return true;}return false;break;case "c":this.SaveUndo("Copy");if(cart_browser_ie){document.execCommand("Copy",null);this.Focus();ComponentArt_CancelEvent(_40);return false;}break;case "x":this.SaveUndo("Cut");if(cart_browser_ie){document.execCommand("Cut",null);this.Focus();ComponentArt_CancelEvent(_40);return false;}break;case "z":this.Undo();ComponentArt_CancelEvent(_40);break;case "y":this.Redo();ComponentArt_CancelEvent(_40);break;}return true;};ComponentArt_Editor.prototype.GetStyle=function(_41){var _42=this.element.contentWindow;var eck=cart_editor_css_key;if(this.LastElement){var _44=this.LastElement;if(this.LastElement.nodeName=="#text"){_44=this.LastElement.parentNode;}if(!cart_browser_ie){try{return this.document.defaultView.getComputedStyle(_44,null).getPropertyValue(_41);}catch(err){return null;}}else{if(this.LastElement.currentStyle&&_41&&eck[_41]){return this.LastElement.currentStyle[eck[_41]];}}}return null;};ComponentArt_Editor.prototype.SetStyle=function(key,_46){this.SaveUndo("Set "+key+":"+_46);var eck=cart_editor_css_key;var _48;if(cart_browser_ie&&this.SelectionBookmark){_48=this.SelectionBookmark;}else{_48=_q10F(this.element);}if(this.EditEngine=="Browser"){switch(key.toLowerCase()){case "color":if(_48.StartOffset<_48.EndOffset){_48.EndOffset--;}_q162(this.element,_48);this.document.execCommand("ForeColor",false,_46);return;break;case "background-color":if(_48.StartOffset<_48.EndOffset){_48.EndOffset--;}_q162(this.element,_48);this.document.execCommand("BackColor",false,_46);return;break;case "font-family":if(_48.StartOffset<_48.EndOffset){_48.EndOffset--;}_q162(this.element,_48);this.document.execCommand("FontName",false,_46);return;break;}}if(ComponentArt_IsSelectionEmpty(_48)){var _49=this.document.createElement("SPAN");if(cart_browser_ie){_49.innerHTML="&#8204;";}_49.style[eck[key]]=_46;ComponentArt_InsertDomElement(this.element,_49,_49);}else{_q163(this.element,_48,{"Element":"span","StyleString":key+":"+_46});}setTimeout(this.Id+".element.contentWindow.focus();"+this.Id+".DomTrace();",1);};ComponentArt_Editor.prototype.InsertFormElement=function(_4a){_4a=_4a.toUpperCase();this.Focus();if(cart_browser_ie){switch(_4a){case "FORM":var _4b=this.document.createElement("FORM");_4b.setAttribute("id","Form1");_4b.setAttribute("style","height:150px;width:150px;");_4b.innerHTML="&nbsp;";ComponentArt_InsertDomElement(this.element,_4b);break;case "BUTTON":this.document.execCommand("InsertButton",true,"Button");break;case "CHECKBOX":this.document.execCommand("InsertInputCheckbox",true,"Checkbox");break;case "HIDDEN":this.document.execCommand("InsertInputHidden",true,"Hidden");break;case "RADIO":this.document.execCommand("InsertInputRadio",true,"Radio");break;case "PASSWORD":this.document.execCommand("InsertInputPassword",true,"Password");break;case "RESET":this.document.execCommand("InsertInputReset",true,"Reset");break;case "SELECT":this.document.execCommand("InsertSelectDropdown",true,"Select");break;case "TEXTBOX":this.document.execCommand("InsertInputText",true,"Textbox");break;case "TEXTAREA":this.document.execCommand("InsertTextArea",true,"Textarea");break;case "SUBMIT":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);_4b.setAttribute("value","submit");ComponentArt_InsertDomElement(this.element,_4b);break;}}else{switch(_4a){case "FORM":var _4b=this.document.createElement("FORM");_4b.setAttribute("id","Form1");_4b.setAttribute("style","height:150px;width:150px;");_4b.innerHTML="&nbsp;";ComponentArt_InsertDomElement(this.element,_4b);break;case "BUTTON":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);_4b.setAttribute("value","button");ComponentArt_InsertDomElement(this.element,_4b);break;case "CHECKBOX":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);ComponentArt_InsertDomElement(this.element,_4b);break;case "HIDDEN":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);ComponentArt_InsertDomElement(this.element,_4b);break;case "RADIO":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);ComponentArt_InsertDomElement(this.element,_4b);break;case "PASSWORD":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);ComponentArt_InsertDomElement(this.element,_4b);break;case "RESET":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);_4b.setAttribute("value","reset");ComponentArt_InsertDomElement(this.element,_4b);break;case "SELECT":var _4b=this.document.createElement("SELECT");ComponentArt_InsertDomElement(this.element,_4b);break;case "TEXTBOX":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type","text");ComponentArt_InsertDomElement(this.element,_4b);break;case "TEXTAREA":var _4b=this.document.createElement("TEXTAREA");ComponentArt_InsertDomElement(this.element,_4b);break;case "SUBMIT":var _4b=this.document.createElement("INPUT");_4b.setAttribute("type",_4a);_4b.setAttribute("value","submit");ComponentArt_InsertDomElement(this.element,_4b);break;}}};ComponentArt_Editor.prototype.TableInsertRow=function(_4c){var _4d=this.HasParent("TD");if(!_4d){return;}this.SaveUndo("Insert Row");if(this.SelectionBookmarkPaths){this.Focus();_q162(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _4e=ComponentArt_GetTDInfo(_4d);var _4f=this.document.createElement("TR");for(x=0;x<_4e.table.rows[_4e.row].cells.length;x++){var _50=_4e.table.rows[_4e.row].cells[x].cloneNode(false);_50.innerHTML="&nbsp;";_4f.appendChild(_50);}if(_4c){_4e.table.firstChild.insertBefore(_4f,_4e.table.rows[_4e.row].nextSibling);}else{_4e.table.firstChild.insertBefore(_4f,_4e.table.rows[_4e.row]);}};ComponentArt_Editor.prototype.TableInsertColumn=function(_51){var _52=this.HasParent("TD");if(!_52){return;}this.SaveUndo("Insert Column");if(this.SelectionBookmarkPaths){this.Focus();_q162(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _53=ComponentArt_GetTDInfo(_52);for(x=0;x<_53.table.rows.length;x++){var _54=this.document.createElement("TD");_54.innerHTML="&nbsp;";if(_51){_53.table.rows[x].insertBefore(_54,_53.table.rows[x].cells[_53.col].nextSibling);}else{_53.table.rows[x].insertBefore(_54,_53.table.rows[x].cells[_53.col]);}}};ComponentArt_Editor.prototype.TableDeleteCell=function(){var _55=this.HasParent("TD");if(!_55){return;}this.SaveUndo("Delete Cell");if(this.SelectionBookmarkPaths){this.Focus();_q162(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _56=ComponentArt_GetTDInfo(_55);if(_55.previousSibling){_55.previousSibling.colSpan=_55.previousSibling.colSpan+_55.colSpan;ComponentArt_FocusElement(this.element,_55.previousSibling);}else{if(_55.nextSibling){_55.nextSibling.colSpan=_55.nextSibling.colSpan+_55.colSpan;ComponentArt_FocusElement(this.element,_55.nextSibling);}}_55.parentNode.removeChild(_55);if(ComponentArt_IsTableEmpty(_56.table)){_56.table.parentNode.removeChild(_56.table);}this.DomTrace();};ComponentArt_Editor.prototype.TableDeleteColumn=function(){var col=this.HasParent("TD");if(!col){return;}this.SaveUndo("Delete Column");if(this.SelectionBookmarkPaths){this.Focus();_q162(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}var _58=ComponentArt_GetTDInfo(col);for(x=0;x<_58.table.rows.length;x++){if(_58.table.rows[x].cells[_58.col]){_58.table.rows[x].removeChild(_58.table.rows[x].cells[_58.col]);}}if(ComponentArt_IsTableEmpty(_58.table)){_58.table.parentNode.removeChild(_58.table);}this.DomTrace();};ComponentArt_Editor.prototype.TableDeleteRow=function(){var row=this.HasParent("TR");if(!row){return;}var _5a=row.parentNode.parentNode;this.SaveUndo("Delete Row");if(this.SelectionBookmarkPaths){this.Focus();_q162(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}row.parentNode.removeChild(row);if(ComponentArt_IsTableEmpty(_5a)){_5a.parentNode.removeChild(_5a);}this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellRight=function(){var _5b=this.HasParent("TD");if(!_5b){return;}this.SaveUndo("Merge Cell Right");this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellDown=function(){var _5c=this.HasParent("TD");if(!_5c){return;}this.SaveUndo("Merge Cell Down");this.DomTrace();};ComponentArt_Editor.prototype.TableSplitCellHorizontal=function(){var _5d=this.HasParent("TD");if(!_5d){return;}this.SaveUndo("Split Cell");var _5e=ComponentArt_GetTDInfo(_5d);var _5f=this.document.createElement("TD");_5f.innerHTML="&nbsp;";_5e.table.rows[_5e.row].insertBefore(_5f,_5d.nextSibling);if(_5d.colSpan>1){_5d.colSpan=_5d.colSpan-1;}else{for(x=0;x<_5e.table.rows.length;x++){if(_5e.table.rows[x].cells[_5e.col]){if(_5e.table.rows[x].cells[_5e.col]!=_5d){_5e.table.rows[x].cells[_5e.col].colSpan=_5e.table.rows[x].cells[_5e.col].colSpan+1;}}}}this.DomTrace();};ComponentArt_Editor.prototype.TableSplitCellVertical=function(){var _60=this.HasParent("TD");if(!_60){return;}this.SaveUndo("Split Cell");var _61=ComponentArt_GetTDInfo(_60);if(_60.rowSpan>1){var _62=this.document.createElement("TD");_62.innerHTML="&nbsp;";_61.table.rows[_61.row+1].insertBefore(_62,_61.table.rows[_61.row+1].cells[_61.col].nextSibling);_60.rowSpan=_60.rowSpan-1;}else{for(x=0;x<_61.table.rows[_61.row].cells.length;x++){if(_61.table.rows[_61.row].cells[x]){if(_61.table.rows[_61.row].cells[x]!=_60){_61.table.rows[_61.row].cells[x].rowSpan=_61.table.rows[_61.row].cells[x].rowSpan+1;}}}var tr=this.document.createElement("TR");var _62=this.document.createElement("TD");_62.innerHTML="&nbsp;";tr.appendChild(_62);_61.table.firstChild.insertBefore(tr,_61.table.rows[_61.row].nextSibling);}this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellDown=function(){var _64=this.HasParent("TD");if(!_64){return;}var _65=ComponentArt_GetTDInfo(_64);if(!_65.table.rows[_65.row+1]||!_65.table.rows[_65.row+1].cells[_65.col]){return;}this.SaveUndo("Merge Down");_64.innerHTML=_64.innerHTML+_65.table.rows[_65.row+1].cells[_65.col].innerHTML;_64.rowSpan=_64.rowSpan+1;_65.table.rows[_65.row+1].removeChild(_65.table.rows[_65.row+1].cells[_65.col]);this.DomTrace();};ComponentArt_Editor.prototype.TableMergeCellRight=function(){var _66=this.HasParent("TD");if(!_66||!_66.nextSibling){return;}this.SaveUndo("Merge Right");_66.innerHTML+=_66.nextSibling.innerHTML;_66.colSpan=_66.colSpan+1;_66.parentNode.removeChild(_66.nextSibling);this.DomTrace();};ComponentArt_Editor.prototype.ToggleUnorderedList=function(){this.SaveUndo("Unordered List");if(this.SelectionBookmarkPaths){_q162(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}else{if(this.SelectionBookmark){_q162(this.element,this.SelectionBookmark);this.set_selectionBookmark(null);}}this.document.execCommand("InsertUnorderedList",false,null);this.DomTrace();this.Focus();};ComponentArt_Editor.prototype.ToggleOrderedList=function(){this.SaveUndo("Ordered List");if(this.SelectionBookmarkPaths){_q162(this.element,ComponentArt_SelectionPathsToInfo(this.element,this.SelectionBookmarkPaths));this.SelectionBookmarkPaths=null;}else{if(this.SelectionBookmark){_q162(this.element,this.SelectionBookmark);this.set_selectionBookmark(null);}}this.document.execCommand("InsertOrderedList",false,null);this.DomTrace();this.Focus();};ComponentArt_Editor.prototype.GetTopUnorderedList=function(_67){return this.TopParent("UL",_67);};ComponentArt_Editor.prototype.GetTopOrderedList=function(_68){return this.TopParent("OL",_68);};ComponentArt_Editor.prototype.SetUnorderedListCssClass=function(_69,_6a){var _6b=this.GetTopUnorderedList(_6a);if(_6b){_6b.className=_69;}};ComponentArt_Editor.prototype.SetOrderedListCssClass=function(_6c,_6d){var _6e=this.GetTopOrderedList(_6d);if(_6e){_6e.className=_6c;}};ComponentArt_Editor.prototype.get_selectionText=function(){var doc=this.element.contentWindow.document;var _70="";if(cart_browser_ie){this.element.focus();var _71=doc.selection.createRange();_70=_71.text;}else{var _72;if(this.element.contentWindow.getSelection){_72=this.element.contentWindow.getSelection();}else{if(doc.selection){_72=doc.selection.createRange();}}var _71;if(_72.getRangeAt){_71=_72.getRangeAt(0);}else{_71=doc.createRange();_71.setStart(_72.anchorNode,_72.anchorOffset);_71.setEnd(_72.focusNode,_72.focusOffset);}_70=_71.toString();}return _70;};ComponentArt_Editor.prototype.get_selection=function(){return _q10F(this.element);};ComponentArt_Editor.prototype.set_selection=function(_73){return _q162(this.element,_73);};ComponentArt_Editor.prototype.ApplyTag=function(tag){this.SaveUndo("Tag "+tag);if(cart_browser_ie&&this.SelectionBookmark){var _75=this.SelectionBookmark;this.SelectionBookmark=null;}else{var _75=_q10F(this.element);}_q163(this.element,_75,{"Element":tag,"StyleString":""});setTimeout(this.Id+".element.contentWindow.focus();"+this.Id+".DomTrace()",1);};ComponentArt_Editor.prototype.ToggleStyle=function(key,_77){};ComponentArt_Editor.prototype.SaveData=function(){if(!this.EnableViewState){return;}var _78=document.getElementById(this.Id+"_Content");if(_78){var _79=this.document.body.innerHTML;var _7a=window.encodeURIComponent?encodeURIComponent(_79):escape(_79);_78.value=_7a;}var _7b=document.getElementById(this.Id+"_Text");if(_7b){var _79=cart_browser_ie?this.document.body.innerText:this.document.body.textContent;_7b.value=_79;}var _7c=document.getElementById(this.Id+"_Textarea");if(_7c){_7c.value="";}};ComponentArt_Editor.prototype.InsertImage=function(url,alt,_7f,_80,_81,_82,_83,_84,_85,_86){image=this.document.createElement("IMG");if(url){if(this.PreserveRelativePaths&&url.toLowerCase().indexOf("http")==-1){image.setAttribute("relativesrc",url);}if(cart_browser_mozilla&&url.toLowerCase().indexOf("http")==-1){var _87=location.href.substring(0,location.href.indexOf("/",10));url=(url.substring(0,1)=="/")?_87+url:_87+"/"+url;}image.setAttribute("src",url);}if(alt){image.setAttribute("alt",alt);}if(_7f){image.setAttribute("width",_7f);}if(_80){image.setAttribute("height",_80);}if(_82){image.setAttribute("border",_82);}if(_83){image.setAttribute("hspace",_83);}if(_84){image.setAttribute("vspace",_84);}if(_85){image.setAttribute(cart_browser_ie?"className":"class",_85);}if(_86){image.setAttribute("style",_86);}ComponentArt_InsertDomElement(this.element,image,image);};ComponentArt_Editor.prototype.InsertHyperlink=function(url,_89,_8a,_8b,id,_8d,_8e){link=ComponentArt_CreateElementWithName(this.document,"A",_8d);if(url){link.setAttribute("href",url);}if(_89){link.innerHTML=_89;}if(_8a){link.setAttribute("target",_8a);}if(_8e){link.setAttribute("tooltip",_8e);}if(_8b){link.setAttribute(cart_browser_ie?"className":"class",_8b);}if(id){link.setAttribute("id",id);}ComponentArt_InsertDomElement(this.element,link,link);};ComponentArt_Editor.prototype.SaveUndo=function(_8f){this.RedoStates=new Array();var _90=new Object;_90.innerHTML=this.document.body.innerHTML;_90.selection=ComponentArt_SelectionInfoToPaths(this.get_selection());_90.action=_8f;this.action=_8f;this.UndoStates.push(_90);this.typing=false;this.RaiseContextChange();this.UpdateActions();};ComponentArt_Editor.prototype.Redo=function(_91){if(_91==null){_91=1;}if(this.RedoStates.length<_91){return;}if(this.get_mode()!="design"){return;}var _92={"innerHTML":this.document.body.innerHTML,"selection":ComponentArt_SelectionInfoToPaths(this.get_selection())};for(var i=0;i<_91;i++){var _94=this.RedoStates.pop();_92.action=_94.action;this.UndoStates.push(_92);_92=_94;}this.document.body.innerHTML=_92.innerHTML.toString();this.DomTrace();try{this.set_selection(ComponentArt_SelectionPathsToInfo(this.element,_92.selection));}catch(err){}this.RaiseContextChange();this.UpdateActions();this.Focus();};ComponentArt_Editor.prototype.Undo=function(_95){if(_95==null){_95=1;}if(this.UndoStates.length<_95){return;}if(this.get_mode()!="design"){return;}var _96={"innerHTML":this.document.body.innerHTML,"selection":ComponentArt_SelectionInfoToPaths(this.get_selection())};for(var i=0;i<_95;i++){var _98=this.UndoStates.pop();_96.action=_98.action;this.RedoStates.push(_96);_96=_98;}this.document.body.innerHTML=_96.innerHTML.toString();this.DomTrace();this.set_selection(ComponentArt_SelectionPathsToInfo(this.element,_96.selection));this.RaiseContextChange();this.UpdateActions();this.Focus();};ComponentArt_Editor.prototype.BeforeElementChange=function(){};ComponentArt_Editor.prototype.AfterElementChange=function(){this.UpdateBreadcrumbs();this.RaiseContextChange();};ComponentArt_Editor.prototype.DomTrace=function(_99){this.UpdateCounts();if(cart_browser_ie){_99=this.element.contentWindow.event;var _9a=this.document.selection.createRange();if(!_9a.parentElement){return;}_99=_9a.parentElement();if(this.LastElement!=_99){this.BeforeElementChange();this.LastElement=_99;this.AfterElementChange();}}else{var _9a=this.element.contentWindow.getSelection(this.element);if(_9a){_99=_9a.anchorNode;}else{return;}if(this.LastElement!=_99){this.BeforeElementChange();this.LastElement=_99;this.AfterElementChange();}}};ComponentArt_Editor.prototype.HasParent=function(_9b){var _9c=this.LastElement;var _9d=0;while(_9c&&_9c.nodeName!="BODY"){if(_9c.nodeName.indexOf(_9b)>-1){_9c.depth=_9d;return _9c;}_9d++;_9c=_9c.parentNode;}return false;};ComponentArt_Editor.prototype.TopParent=function(_9e,_9f){var _a0=_9f?_9f:this.LastElement;var _a1=false;while(_a0&&_a0.nodeName!="BODY"){if(_a0.nodeName.indexOf(_9e)>-1){_a1=_a0;}_a0=_a0.parentNode;}return _a1;};ComponentArt_Editor.prototype.HasCssClass=function(_a2){var _a3=this.LastElement;if(!_a3){return false;}if(cart_browser_ie){while(_a3.nodeName!="BODY"){if(_a3.className==_a2){return true;}_a3=_a3.parentNode;}}else{while(_a3&&_a3.nodeName&&_a3.nodeName!="BODY"){if(_a3.className==_a2){return true;}_a3=_a3.parentNode;}}return false;};ComponentArt_Editor.prototype.SetIndent=function(_a4){this.SaveUndo("Indent");if(this.EditEngine=="Browser"){if(_a4>0){this.document.execCommand("Indent","","");}else{this.document.execCommand("Outdent","","");}return;}var _a5=25;var _a6=this.HasParent("LI");if(_a6){var _a7=(_a6.style.marginLeft-0==0)?0:parseInt(_a6.style.marginLeft);var _a8=_a7+(_a4*_a5);if(_a8>=0){_a6.style.marginLeft=_a8+"px";}return;}var _a9=this.HasParent("DIV");if(_a9){var _a7=(_a9.style.marginLeft-0==0)?0:parseInt(_a9.style.marginLeft);var _a8=_a7+(_a4*_a5);if(_a8>=0){_a9.style.marginLeft=_a8+"px";}}else{var _aa=this.document.createElement("div");var _a8=_a4*_a5;if(_a8>=0){_aa.style.marginLeft=_a8+"px";}if(this.LastElement.nodeName=="BODY"){var _ab=this.LastElement.innerHTML;_aa.innerHTML=_ab;this.LastElement.innerHTML="";this.LastElement.appendChild(_aa);}else{}}this.Focus();};ComponentArt_Editor.prototype.SetAlign=function(_ac){this.SaveUndo("Align");if(this.EditEngine=="Browser"){switch(_ac.toLowerCase()){case "right":this.document.execCommand("JustifyRight",false,null);return;break;case "left":this.document.execCommand("JustifyLeft",false,null);return;break;case "center":this.document.execCommand("JustifyCenter",false,null);return;break;case "justify":this.document.execCommand("JustifyFull",false,null);return;break;}}var _ad=this.LastElement;if(_ad.nodeName=="TD"){_ad.style.textAlign=_ac;return;}_ad=this.HasParent("TABLE");if(_ad){_ad.style.textAlign=_ac;return;}_ad=this.HasParent("H");if(_ad){_ad.style.textAlign=_ac;return;}_ad=this.HasParent("LI");if(_ad){_ad.style.textAlign=_ac;return;}_ad=this.HasParent("DIV");if(_ad){_ad.style.textAlign=_ac;}else{var _ae=this.document.createElement("div");_ae.style.textAlign=_ac;if(this.LastElement.nodeName=="BODY"){var _af=this.LastElement.innerHTML;_ae.innerHTML=_af;this.LastElement.innerHTML="";this.LastElement.appendChild(_ae);}else{}}this.DomTrace();this.Focus();};ComponentArt_Editor.prototype.GetListContext=function(){var _b0=this.HasParent("OL");var _b1=this.HasParent("UL");if(_b0&&!_b1||_b0.depth<_b1.depth){return _b0;}if(_b1&&!_b0||_b1.depth<_b0.depth){return _b1;}return false;};ComponentArt_Editor.prototype.SaveBookmark=function(){if(this.get_mode()=="source"||this.get_editMode()!="Default"){return;}if(!this.SelectionBookmark&&cart_browser_ie){this.SelectionBookmark=_q10F(this.element);}if(!this.SelectionBookmarkPaths&&cart_browser_ie){this.SelectionBookmarkPaths=ComponentArt_SelectionInfoToPaths(_q10F(this.element));}};ComponentArt_Editor.prototype.Save=function(){var _b2=true;var _b3=this.document.body.innerHTML;_b3=_b3.replace(/</g,"%#CLT#%");var _b4=window.encodeURIComponent?encodeURIComponent(_b3):escape(_b3);var _b5=cart_browser_ie?this.document.body.innerText:this.document.body.textContent;var _b6=window.encodeURIComponent?encodeURIComponent(_b5):escape(_b5);var _b7="Cart_"+this.Id+"_Content="+_b4+"&Cart_"+this.Id+"_Text="+_b6;var url=location.href;url+=url.indexOf("?")>0?"&":"?";url+="Cart_"+this.Id+"_Callback=yes";var _b9=this;var _ba=false;var _bb;var _bc=null;function Cleanup(){_b9.CallingBack=false;}function _q19E(){if(_bb.readyState&&_bb.readyState!=4&&_bb.readyState!="complete"){return;}var _bd=_ba?_bb.responseXML:_bb;if(_bd&&_bd.documentElement&&_bd.documentElement.childNodes.length==1){var _be=_bd.documentElement.childNodes[0];var _bf=_be.nodeValue;_bc=eval(_bf);if(_bc){var _c0=_b9.get_events().getHandler("saveSuccess");if(_c0){_c0(_b9,Sys.EventArgs.Empty);}}else{var _c0=_b9.get_events().getHandler("saveError");if(_c0){_c0(_b9,Sys.EventArgs.Empty);}}}else{if(_bb.status&&_bb.status!=200&&_bb.responseText){document.body.innerHTML=_bb.responseText;}else{alert("Error loading callback data.");}}Cleanup();}this.CallingBack=true;if(window.XMLHttpRequest){_ba=true;var _bb=new XMLHttpRequest();_bb.onreadystatechange=_q19E;_bb.open("POST",url,true);_bb.setRequestHeader("Content-Type","application/x-www-form-urlencoded");_bb.send(_b7);}else{if(document.implementation&&document.implementation.createDocument){_bb=document.implementation.createDocument("","",null);_bb.onload=_q19E;}else{if(cart_browser_ie){if(window.ActiveXObject){try{_bb=new ActiveXObject("Microsoft.XMLHTTP");_bb.onreadystatechange=_q19E;_bb.open("POST",url,true);_bb.setRequestHeader("Content-Type","application/x-www-form-urlencoded");_bb.send(_b7);_ba=true;}catch(ex){}}if(_bb==null){var _c1=this.Id+"_island";var _c2=document.getElementById(_c1);if(!_c2){_c2=document.createElement("xml");_c2.id=_c1;document.body.appendChild(_c2);}if(_c2.XMLDocument){_bb=_c2.XMLDocument;_bb.onreadystatechange=_q19E;}else{return false;}}}else{return false;}}}if(!_ba){_bb.async=true;try{_bb.load(url+"&"+_b7);}catch(ex){Cleanup();alert("Data not loaded: "+(ex.message?ex.message:ex));}}return true;};ComponentArt_Editor.prototype.Find=function(_c3,_c4,_c5,_c6){var _c7=ComponentArt_Find(this.element,_c3,_c4,_c5,_c6);if(_c7){_q162(this.element,_c7);ComponentArt_ScrollSelectionIntoView(this.element,_c7);}return _c7;};ComponentArt_Editor.prototype.Replace=function(_c8,_c9,_ca,_cb,_cc){var _cd=ComponentArt_Find(this.element,_c8,_c9,_ca,_cc);if(_cd){ComponentArt_ScrollSelectionIntoView(this.element,_cd);ComponentArt_Replace(_cd,_cb);}return _cd;};ComponentArt_Editor.prototype.ReplaceAll=function(_ce,_cf,_d0,_d1){var _d2=null;do{_d2=ComponentArt_Find(this.element,_ce,_cf,_d0);if(_d2){ComponentArt_Replace(_d2,_d1);}}while(_d2);};ComponentArt_Editor.prototype.KeyDown=function(_d3){_d3=_d3?_d3:this.element.contentWindow.event;this.DomTrace(_d3);if(this.LastElement.nodeName=="BUTTON"){return true;}if(this.EditEngine=="Browser"&&cart_browser_ie){if(ComponentArt_Cntrl&&_d3.keyCode!="17"){var key=String.fromCharCode(_d3.keyCode).toLowerCase();var _d5="buivcx";if(key=="z"){this.Undo();ComponentArt_CancelEvent(_d3);return false;}else{if(key=="y"){this.Redo();ComponentArt_CancelEvent(_d3);return false;}else{if(_d5.indexOf(key)>-1){this.SaveUndo("Ctrl Command");}}}}else{if(_d3.keyCode=="17"){ComponentArt_Cntrl=true;}}switch(cart_editor_typing_key_codes[_d3.keyCode]){case 0:break;case 1:this.typing=false;break;default:if(!this.typing){this.SaveUndo("Typing");this.typing=true;}break;}return true;}switch(cart_editor_typing_key_codes[_d3.keyCode]){case 0:break;case 1:this.typing=false;break;default:if(!this.typing){this.SaveUndo("Typing");this.typing=true;}break;}if(cart_browser_ie||cart_browser_opera){if(_d3.keyCode=="8"){var _d6=this.GetListContext();if(_d6.nodeName=="OL"){this.SaveUndo("Backspace");var _d7=_q10F(this.element);ComponentArt_DebugSelection(_d7);if(_d7.CommonAncestorContainer.nodeName=="LI"&&_d7.StartOffset==0){ComponentArt_CancelEvent(_d3);return false;}}}if(_d3.keyCode=="9"){var _d6=this.GetListContext();if(_d6.nodeName=="OL"){this.SaveUndo("Tab");var _d7=_q10F(this.element);if(_d7.CommonAncestorContainer.nodeName=="LI"&&_d7.StartOffset==0){var ol=this.document.createElement("ol");var li=this.document.createElement("li");ol.appendChild(li);ComponentArt_SwapDomElement(this,this.HasParent("LI"),ol,li);ComponentArt_CancelEvent(_d3);return false;}}else{if(_d6.nodeName=="UL"){this.SaveUndo("Tab");var _d7=_q10F(this.element);if(_d7.CommonAncestorContainer.nodeName=="LI"&&_d7.StartOffset==0){var ul=this.document.createElement("ul");var li=this.document.createElement("li");ul.appendChild(li);ComponentArt_SwapDomElement(this,this.HasParent("LI"),ul,li);ComponentArt_CancelEvent(_d3);return false;}}}var tab=this.document.createElement("span");tab.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";ComponentArt_InsertDomElement(this.element,tab.childNodes);ComponentArt_CancelEvent(_d3);return false;}if(_d3.keyCode=="13"){var _dc=this.HasParent("LI");if(_dc){this.SaveUndo("Enter");var _dd=this.get_events().getHandler("enter");if(_dd){_dd(this,Sys.EventArgs.Empty);}return true;}var _de=this.HasParent("TD");var _df=this.HasParent("DIV");if(_de&&!_df||_de&&_df.depth>_de.depth){this.SaveUndo("Enter");var _e0=this.document.createElement("div");ComponentArt_AddChildDom(this,_e0);ComponentArt_SplitDomElement(this.element,_e0);ComponentArt_CancelEvent(_d3);var _dd=this.get_events().getHandler("enter");if(_dd){_dd(this,Sys.EventArgs.Empty);}return false;}if(_df){this.SaveUndo("Enter");ComponentArt_SplitDomElement(this.element,_df);ComponentArt_CancelEvent(_d3);var _dd=this.get_events().getHandler("enter");if(_dd){_dd(this,Sys.EventArgs.Empty);}return false;}var _e1=this.HasParent("H");if(_e1){this.SaveUndo("Enter");ComponentArt_SplitDomElement(this.element,_e1);ComponentArt_CancelEvent(_d3);var _dd=this.get_events().getHandler("enter");if(_dd){_dd(this,Sys.EventArgs.Empty);}return false;}var _e0=this.document.createElement("div");ComponentArt_AddChildDom(this,_e0);ComponentArt_SplitDomElement(this.element,_e0);ComponentArt_CancelEvent(_d3);var _dd=this.get_events().getHandler("enter");if(_dd){_dd(this,Sys.EventArgs.Empty);}return false;}if(ComponentArt_Cntrl&&_d3.keyCode!="17"){var _d5="bcdefghijklmnopqrstuvwxyz";if(_d5.indexOf(String.fromCharCode(_d3.keyCode).toLowerCase())>-1){return this.CntrlCommand(String.fromCharCode(_d3.keyCode).toLowerCase(),_d3);}}else{if(_d3.keyCode=="17"){ComponentArt_Cntrl=true;}}}else{if(cart_browser_safari){if(_d3.which=="13"){r=this.document.selection.createRange();var _dc=this.HasParent("LI");if(_dc){ComponentArt_SplitDomElement(this.element,_dc);ComponentArt_CancelEvent(_d3);return;}_d3.preventDefault();_d3.stopPropagation();return false;}if(_d3.ctrlKey){switch(_d3.keyCode){case 66:this.CntrlCommand("b",_d3);ComponentArt_CancelEvent(_d3);_d3.preventDefault();_d3.stopPropagation();return false;break;case 73:this.CntrlCommand("i",_d3);ComponentArt_CancelEvent(_d3);_d3.preventDefault();_d3.stopPropagation();return false;break;case 89:this.CntrlCommand("y",_d3);ComponentArt_CancelEvent(_d3);_d3.preventDefault();_d3.stopPropagation();return false;break;case 90:this.CntrlCommand("y",_d3);ComponentArt_CancelEvent(_d3);_d3.preventDefault();_d3.stopPropagation();return false;break;default:break;}}}}return true;};ComponentArt_Editor.prototype.KeyUp=function(_e2){_e2=this.element.contentWindow.event;this.DomTrace(_e2);if(cart_browser_ie||cart_browser_safari||cart_browser_opera){if(_e2.keyCode=="17"){ComponentArt_Cntrl=false;}}};ComponentArt_Editor.prototype.KeyPress=function(_e3){if(!cart_browser_ie&&_e3.type=="keypress"){if(_e3.ctrlKey){if(this.EditEngine=="Browser"){switch(String.fromCharCode(_e3.charCode).toLowerCase()){case "b":this.SaveUndo("Bold");this.document.execCommand("bold",false,null);ComponentArt_CancelEvent(_e3);_e3.preventDefault();_e3.stopPropagation();return false;break;case "i":this.SaveUndo("Italic");this.document.execCommand("italic",false,null);ComponentArt_CancelEvent(_e3);_e3.preventDefault();_e3.stopPropagation();return false;break;case "u":this.SaveUndo("Underline");this.document.execCommand("underline",false,null);ComponentArt_CancelEvent(_e3);_e3.preventDefault();_e3.stopPropagation();return false;break;}}this.CntrlCommand(String.fromCharCode(_e3.charCode).toLowerCase(),_e3);return true;}else{if(_e3.which=="13"){if(this.EditEngine=="Browser"){return true;}this.SaveUndo("Enter");this.SelectionBookmark=_q10F(this.element);var _e4=this.HasParent("LI");if(_e4){return true;}var _e4=this.HasParent("LI");var _e5=this.HasParent("DIV");var _e6=this.HasParent("H");if(_e4||_e5||_e6){var _e7=document.createElement("DIV");_e7.setAttribute("id","br_pit");_e7.style.visibility="hidden";_e7.style.display="none";document.body.appendChild(_e7);var _e8=new Object;_e8.StartContainer=_e8.EndContainer=_e8.CommonAncestorContainer=_e7;_e8.EndOffset=_e8.StartOffset=0;try{_q162(this.element,_e8);}catch(err){}setTimeout(this.Id+".FireFoxEnter();",0);}return;}else{if(_e3.keyCode=="9"){var _e4=this.HasParent("LI");if(_e4){return true;}var tab=this.document.createElement("span");tab.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";ComponentArt_InsertDomElement(this.element,tab,tab);ComponentArt_CancelEvent(_e3);_e3.preventDefault();_e3.stopPropagation();return false;}else{if(_e3.keyCode=="8"){return true;}}}}}if(cart_browser_opera&&ComponentArt_Cntrl){ComponentArt_CancelEvent(_e3);_e3.preventDefault();_e3.stopPropagation();return false;}};ComponentArt_Editor.prototype.FireFoxEnter=function(){var _ea=this.HasParent("LI");var _eb=this.HasParent("DIV");var _ec=this.HasParent("H");if(_ea){ComponentArt_SplitDomElement(this.element,_ea);}else{if(_eb){ComponentArt_SplitDomElement(this.element,_eb);}else{if(_ec){ComponentArt_SplitDomElement(this.element,_ec);}else{var br=this.document.createElement("br");ComponentArt_InsertDomElement(this.element,br,br);}}}var _ee=this.get_events().getHandler("Enter");if(_ee){_ee(this,Sys.EventArgs.Empty);}};ComponentArt_Editor.prototype.MouseDown=function(_ef){this.SelectionBookmark=null;};ComponentArt_Editor.prototype.MouseUp=function(_f0){};ComponentArt_Editor.prototype.MouseClick=function(_f1){if(this.get_mode()=="source"){return true;}ComponentArt_Editor_CollapseMenus(this);_f1=this.element.contentWindow.event;this.DomTrace(_f1);};ComponentArt_Editor.prototype.MouseMove=function(_f2){};ComponentArt_Editor.prototype.Blur=function(_f3){this.typing=false;this.SaveBookmark();};ComponentArt_Editor.prototype.RaiseContextChange=function(){ComponentArt_Editor_HandleEditorBoxEvent(this,Sys.EventArgs.Empty);var _f4=this.get_events().getHandler("contextChange");if(_f4){_f4(this,Sys.EventArgs.Empty);}};ComponentArt_Editor.prototype.GetClientTemplate=function(sID){if(this.ClientTemplates){for(var i=0;i<this.ClientTemplates.length;i++){if(this.ClientTemplates[i][0]==sID){return this.ClientTemplates[i][1];}}}return null;};window.cart_editor_css_key={"font-weight":"fontWeight","fontWeight":"font-weight","font-style":"fontStyle","fontStyle":"font-style","font-family":"fontFamily","fontFamily":"font-family","font-size":"fontSize","fontSize":"font-size","color":"color","color":"color","text-align":"textAlign","textAlign":"text-align","text-decoration":"textDecoration","textDecoration":"text-decoration","listStyleType":"list-style-type","list-style-type":"listStyleType","listStylePosition":"list-style-position","list-style-position":"listStylePosition","listStyleImage":"list-style-image","list-style-image":"listStyleImage","background-color":"backgroundColor","backgroundColor":"background-color"};window.cart_editor_typing_key_codes={"0":1,"16":0,"17":0,"18":0,"19":0,"20":0,"27":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"44":0,"45":1,"46":1,"144":0,"145":0};var ComponentArt_Cntrl=false;var ComponentArt_Editor_Kernel_Loaded=true;
