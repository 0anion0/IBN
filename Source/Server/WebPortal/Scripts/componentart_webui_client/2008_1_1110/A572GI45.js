window.cart_editor_command_type={"Save":0,"0":"Save","EditUndo":1,"1":"EditUndo","EditRedo":2,"2":"EditRedo","EditCut":3,"3":"EditCut","EditCopy":4,"4":"EditCopy","EditPaste":5,"5":"EditPaste","ViewRevealFormatting":6,"6":"ViewRevealFormatting","InsertHyperlink":7,"7":"InsertHyperlink","FormatFont":8,"8":"FormatFont","FormatFontFace":9,"9":"FormatFontFace","FormatFontSize":10,"10":"FormatFontSize","FormatBold":11,"11":"FormatBold","FormatItalic":12,"12":"FormatItalic","FormatUnderline":13,"13":"FormatUnderline","FormatFontColor":14,"14":"FormatFontColor","FormatHighlight":15,"15":"FormatHighlight","FormatNumbering":16,"16":"FormatNumbering","FormatBullets":17,"17":"FormatBullets","FormatAlignLeft":18,"18":"FormatAlignLeft","FormatAlignCenter":19,"19":"FormatAlignCenter","FormatAlignRight":20,"20":"FormatAlignRight","FormatAlignJustify":21,"21":"FormatAlignJustify","ToolsSpelling":22,"22":"ToolsSpelling","ToolsSetLanguage":23,"23":"ToolsSetLanguage","InsertHorizontalRule":24,"24":"InsertHorizontalRule","FormatIncreaseIndent":25,"25":"FormatIncreaseIndent","FormatDecreaseIndent":26,"26":"FormatDecreaseIndent","FormatStyle":27,"27":"FormatStyle","EditUndoExtended":28,"28":"EditUndoExtended","EditRedoExtended":29,"29":"EditRedoExtended","FormatStrikethrough":30,"30":"FormatStrikethrough","Print":31,"31":"Print","TableInsertRowAbove":32,"32":"TableInsertRowAbove","TableInsertRowBelow":33,"33":"TableInsertRowBelow","TableInsertColumnRight":34,"34":"TableInsertColumnRight","TableInsertColumnLeft":35,"35":"TableInsertColumnLeft","TableDeleteRow":36,"36":"TableDeleteRow","TableDeleteColumn":37,"37":"TableDeleteColumn","TableDeleteCell":38,"38":"TableDeleteCell","TableMergeCellRight":39,"39":"TableMergeCellRight","TableMergeCellDown":40,"40":"TableMergeCellDown","TableSplitCellHorizontal":41,"41":"TableSplitCellHorizontal","TableSplitCellVertical":42,"42":"TableSplitCellVertical","InsertForm":43,"43":"InsertForm","InsertButton":44,"44":"InsertButton","InsertCheckbox":45,"45":"InsertCheckbox","InsertHidden":46,"46":"InsertHidden","InsertRadio":47,"47":"InsertRadio","InsertPassword":48,"48":"InsertPassword","InsertReset":49,"49":"InsertReset","InsertSelect":50,"50":"InsertSelect","InsertSubmit":51,"51":"InsertSubmit","InsertTextbox":52,"52":"InsertTextbox","InsertTextarea":53,"53":"InsertTextarea","RemoveHyperlink":54,"54":"RemoveHyperlink","New":55,"55":"New","EditFind":56,"56":"EditFind","EditReplace":57,"57":"EditReplace","InsertMedia":58,"58":"InsertMedia","InsertSymbol":59,"59":"InsertSymbol","InsertTable":60,"60":"InsertTable","FormatNumberingExtended":61,"61":"FormatNumberingExtended","FormatBulletsExtended":62,"62":"FormatBulletsExtended","ImageManager":63,"63":"ImageManager"};window.cart_editor_commands_to_context_metrics={"Save":[],"EditUndo":["CanUndo"],"EditRedo":["CanRedo"],"EditCut":[],"EditCopy":[],"EditPaste":[],"ViewRevealFormatting":[],"InsertHyperlink":[],"RemoveHyperlink":["linkContext"],"FormatFont":[],"FormatFontFace":["font-family"],"FormatFontSize":["font-size"],"FormatBold":["font-weight"],"FormatItalic":["font-style"],"FormatUnderline":["text-decoration"],"FormatFontColor":[],"FormatHighlight":[],"FormatNumbering":["listContext"],"FormatBullets":["listContext"],"FormatAlignLeft":["text-align"],"FormatAlignCenter":["text-align"],"FormatAlignRight":["text-align"],"FormatAlignJustify":["text-align"],"ToolsSpelling":[],"ToolsSetLanguage":[],"InsertHorizontalRule":[],"FormatIncreaseIndent":[],"FormatDecreaseIndent":[],"FormatStyle":[],"EditUndoExtended":["UndoCount"],"EditRedoExtended":["RedoCount"],"FormatStrikethrough":["text-decoration"],"Print":[],"TableInsertRowAbove":["tableContext"],"TableInsertColumnRight":["tableContext"],"TableInsertRowBelow":["tableContext"],"TableInsertColumnLeft":["tableContext"],"TableDeleteRow":["tableContext"],"TableDeleteColumn":["tableContext"],"TableDeleteCell":["tableContext"],"TableMergeCellRight":["tableContext"],"TableMergeCellDown":["tableContext"],"TableSplitCellHorizontal":["tableContext"],"TableSplitCellVertical":["tableContext"],"InsertForm":[],"InsertButton":[],"InsertCheckbox":[],"InsertHidden":[],"InsertRadio":[],"InsertPassword":[],"InsertReset":[],"InsertSelect":[],"InsertSubmit":[],"InsertTextbox":[],"InsertTextarea":[],"New":[],"EditFind":[],"EditReplace":[],"InsertMedia":[],"InsertSymbol":[],"InsertTable":[],"FormatNumberingExtended":["listContext"],"FormatBulletsExtended":["listContext"],"ImageManager":[]};window.cart_editor_builtInContextMetrics={"font-weight":function(_1){return _1.getStyle("font-weight");},"font-style":function(_2){return _2.getStyle("font-style");},"text-decoration":function(_3){return _3.getStyle("text-decoration");},"text-align":function(_4){return _4.getStyle("text-align");},"font-family":function(_5){return _5.getStyle("font-family");},"font-size":function(_6){return _6.getStyle("font-size");},"listContext":function(_7){return _7.GetListContext().tagName;},"linkContext":function(_8){return _8.HasParent("A").nodeName;},"tableContext":function(_9){return _9.HasParent("TD").nodeName;},"CanUndo":function(_a){return _a.UndoStates.length>0;},"CanRedo":function(_b){return _b.RedoStates.length>0;},"UndoCount":function(_c){return _c.UndoStates.length;},"RedoCount":function(_d){return _d.RedoStates.length;}};function ComponentArt_Editor_InitializeStyles(_e){_e.Styles={};_e.StylesIterator=[];_e.StyleMetrics={};for(var i=0;i<_e.StyleStorage.length;i++){var _10=_e.StyleStorage[i];var _11=_e.StylesIterator[i]=_e.Styles[_10[0]]=new ComponentArt_Style(_10);if(_11.CssClass!=null){ComponentArt_Editor_AddStyleContextMetric(_e,"HasCssClass_"+_11.CssClass,new Function("editor","return editor.HasCssClass(\""+_11.CssClass+"\");"));}if(_11.Element){ComponentArt_Editor_AddStyleContextMetric(_e,"HasParent_"+_11.Element,new Function("editor","return !!editor.HasParent(\""+_11.Element+"\");"));}for(var _12 in _11.Style){if(cart_editor_builtInContextMetrics[cart_editor_css_key[_12]]){ComponentArt_Editor_AddStyleContextMetric(_e,cart_editor_css_key[_12],cart_editor_builtInContextMetrics[cart_editor_css_key[_12]]);}else{ComponentArt_Editor_AddStyleContextMetric(_e,"CssStyle_"+_12,new Function("editor","return editor.getStyle(\""+_12+"\");"));}}}_e.StylesIterator.sort(ComponentArt_Editor_StyleSortCompare);var _13=[];for(var bbb in _e.StyleMetrics){_13[_13.length]=bbb;}cart_editor_commands_to_context_metrics["FormatStyle"]=_13;}function ComponentArt_Editor_AddStyleContextMetric(_15,_16,_17){_15.StyleMetrics[_16]=true;if(_15.ContextMetrics[_16]==null){_15.AddContextMetric(_16,_17);}}function ComponentArt_Editor_HookUpControls(_18){var _19=false;for(var _1a in _18.ControlReferences){var _1b=window[_1a];if(_1b!=null&&_1b.ClientControlId!=null){ComponentArt_Editor_HookUpControl(_18,_1b);}else{_19=true;}}if(_19){setTimeout("ComponentArt_Editor_HookUpControls("+_18.ClientControlId+")",100);}}function ComponentArt_Editor_HookUpControl(_1c,_1d){var _1e=_1d.ClientControlId;_1d.ParentEditor=_1c;var _1f=_1c.ControlReferences[_1e];if(_1f){var _20=window[_1f.ParentToolBarId].get_items().getItem(_1f.ParentItemIndex);_20.ChildControl=_1d;_1d.ParentItem=_20;var _21=_20.GetProperty("EditorCommandType");_1d.EditorCommandType=_21;}if(_1d.constructor===ComponentArt.Web.UI.ToolBar){_1d.add_itemCheckChange(EditorToolBarManager.HandleToolBarEvent);_1d.add_itemSelect(EditorToolBarManager.HandleToolBarEvent);}else{if(_1d.constructor===ComponentArt.Web.UI.ComboBox){_1d.add_change(EditorToolBarManager.HandleComboBoxEvent);}else{if(_1d.constructor===ComponentArt.Web.UI.Menu){}}}ComponentArt_Editor_HookUpContextMetricsAndListeners(_1c,_1d);_1c.ChildControls[_1c.ChildControls.length]=_1d;delete _1c.ControlReferences[_1e];}function ComponentArt_Editor_HookUpContextMetricsAndListeners(_22,_23){if(_23.EditorCommandType){ComponentArt_Editor_HookUpListener(_22,_23.EditorCommandType,_23.ParentItem);}else{if(_23.constructor===ComponentArt.Web.UI.ToolBar){var _24=_23.get_items().get_itemArray();for(var i=_24.length-1;i>=0;i--){var _26=_24[i];var _27=_26.GetProperty("ChildControlId");var _28=_26.GetProperty("EditorCommandType");if(_28&&!_27){ComponentArt_Editor_HookUpListener(_22,_28,_26);}}}}}function ComponentArt_Editor_HookUpListener(_29,_2a,_2b){var _2c=cart_editor_commands_to_context_metrics[_2a];for(var _2d in _2c){var _2e=_2c[_2d];if(_29.ContextMetrics[_2e]==null){_29.AddContextMetric(_2e,cart_editor_builtInContextMetrics[_2e]);}}var _2f=ComponentArt_Editor_UpdateItem[ComponentArt_Editor_ParseEditorCommandType(_2b.GetProperty("EditorCommandType"))];if(_2f){var _30=new Function("editor","editorContext","var item = arguments.callee.item;"+_2f);_30.item=_2b;_29.AddContextChangedEventListener(_30,_2c);}}var ComponentArt_Editor_UpdateItem={1:"      item.SetProperty('Enabled', editorContext['CanUndo']);      item.repaint();",2:"      item.SetProperty('Enabled', editorContext['CanRedo']);      item.repaint();",9:"      var combobox = item.ChildControl;      if (!combobox) {return;}      var itemToSelect = combobox.findItemByProperty('Value', editorContext['font-family'].toLowerCase());      if (!itemToSelect) {return;}      combobox.selectItem(itemToSelect, true);",10:"      var combobox = item.ChildControl;      if (!combobox) {return;}      var itemToSelect = combobox.findItemByProperty('Value', editorContext['font-size']);      if (!itemToSelect) {return;}      combobox.selectItem(itemToSelect, true);",27:"      var combobox = item.ChildControl;      if (!combobox) {return;}      var currentStyle = ComponentArt_Editor_CurrentStyle(editor);      var itemToSelect = currentStyle ? combobox.findItemByProperty('Text', currentStyle.Name) : null; /* HERE IT IS A MINOR SLOWDOWN AND INCONSISTENCY AND HACK.  WE SHOULD CHANGE IT BUT HAVE NO TIME */      if (itemToSelect) {combobox.selectItem(itemToSelect, true);} else {combobox.UnSelect();combobox.set_text('');}",11:"      var fontweight = editorContext['font-weight'];      item.SetProperty('Checked', fontweight == 700 || fontweight == 'bold');      item.repaint();",12:"      item.SetProperty('Checked', editorContext['font-style'] == 'italic');      item.repaint();",13:"      item.SetProperty('Checked', editorContext['text-decoration'].indexOf('underline')>=0 );      item.repaint();",16:"      item.SetProperty('Checked', editorContext['listContext'] == 'OL');      item.repaint();",17:"      item.SetProperty('Checked', editorContext['listContext'] == 'UL');      item.repaint();",18:"      var textAlign = editorContext['text-align'];      item.SetProperty('Checked', textAlign == 'left' || textAlign == 'start'); /*Mozilla seems to return 'start' for unset left align*/      item.repaint();",19:"      item.SetProperty('Checked', editorContext['text-align'] == 'center');      item.repaint();",20:"      item.SetProperty('Checked', editorContext['text-align'] == 'right');      item.repaint();",21:"      item.SetProperty('Checked', editorContext['text-align'] == 'justify');      item.repaint();",28:"      item.SetProperty('Enabled', item.Enabled = editorContext['CanUndo']);      item.repaint();",29:"      item.SetProperty('Enabled', item.Enabled = editorContext['CanRedo']);      item.repaint();",30:"      item.SetProperty('Checked', editorContext['text-decoration'].indexOf('line-through')>=0 );      item.repaint();",32:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",33:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",34:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",35:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",36:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",37:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",38:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",39:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",40:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",41:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",42:"      item.SetProperty('Enabled', editorContext['tableContext'] == 'TD');      item.repaint();",54:"      item.SetProperty('Enabled', editorContext['linkContext'] == 'A');      item.repaint();",61:"      item.SetProperty('Checked', editorContext['listContext'] == 'OL');      item.repaint();",62:"      item.SetProperty('Checked', editorContext['listContext'] == 'UL');      item.repaint();"};window.EditorToolBarManager=new Object();EditorToolBarManager.HandleToolBarEvent=function(_31,_32){var _33=_31.ParentEditor;var _34=_32.get_item();if(_34.CustomContentId||_34.ClientTemplateId){return;}var _35=ComponentArt_Editor_ParseEditorCommandType(_34.GetProperty("EditorCommandType"));EditorToolBarManager.HandleCommand(_33,_35,_34);};EditorToolBarManager.HandleComboBoxEvent=function(_36,_37){var _38=_36.ParentEditor;var _39=ComponentArt_Editor_ParseEditorCommandType(_36.EditorCommandType);EditorToolBarManager.HandleCommand(_38,_39,_36.getSelectedItem());};EditorToolBarManager.HandleCommand=function(_3a,_3b,_3c){if(isNaN(_3b)){return;}var ect=cart_editor_command_type;switch(_3b){case ect.Save:_3a.Save();break;case ect.New:_3a.New();return;break;case ect.EditUndo:case ect.EditUndoExtended:_3a.Undo();break;case ect.EditRedo:case ect.EditRedoExtended:_3a.Redo();break;case ect.EditCut:_3a.CutSelection();return;break;case ect.EditCopy:_3a.CopySelection();return;break;case ect.EditPaste:_3a.PasteHTML(true);return;break;case ect.InsertHyperlink:break;case ect.FormatFont:break;case ect.FormatFontFace:_3a.setStyle("font-family",_3c.get_value());break;case ect.FormatFontSize:_3a.setStyle("font-size",_3c.get_value());break;case ect.FormatStyle:var _3e=null;if(_3a.SelectionBookmark){_3e=_3a.SelectionBookmark;}if(_3c){_q163(_3a.element,_3e,_3a.Styles[_3c.get_value()]);}break;case ect.FormatBold:if(_3a.EditEngine=="Browser"){_3a.SaveUndo("Bold");_3a.document.execCommand("bold",false,null);_3a.DomTrace();return;}_3a.setStyle("font-weight",_3c.get_checked()?"700":"normal");break;case ect.FormatItalic:if(_3a.EditEngine=="Browser"){_3a.SaveUndo("Italic");_3a.document.execCommand("italic",false,null);_3a.DomTrace();return;}_3a.setStyle("font-style",_3c.get_checked()?"italic":"normal");break;case ect.FormatUnderline:if(_3a.EditEngine=="Browser"){_3a.SaveUndo("Underline");_3a.document.execCommand("underline",false,null);_3a.DomTrace();return;}_3a.setStyle("text-decoration",_3c.get_checked()?"underline":"none");break;case ect.FormatStrikethrough:if(_3a.EditEngine=="Browser"){_3a.SaveUndo("Strike Through");_3a.document.execCommand("strikethrough",false,null);return;}_3a.setStyle("text-decoration",_3c.get_checked()?"line-through":"none");break;case ect.FormatFontColor:change_color(_3a);break;case ect.FormatHighlight:change_color(_3a);break;case ect.FormatNumbering:case ect.FormatNumberingExtended:_3a.ToggleOrderedList();break;case ect.FormatBullets:case ect.FormatBulletsExtended:_3a.ToggleUnorderedList();break;case ect.FormatIncreaseIndent:_3a.setIndent(1);break;case ect.FormatDecreaseIndent:_3a.setIndent(-1);break;case ect.FormatAlignLeft:_3a.setAlign("left");break;case ect.FormatAlignCenter:_3a.setAlign("center");break;case ect.FormatAlignRight:_3a.setAlign("right");break;case ect.FormatAlignJustify:_3a.setAlign("justify");break;case ect.ToolsSpelling:break;case ect.ToolsSetLanguage:break;case ect.InsertHorizontalRule:_3a.SaveUndo("Horizontal Rule");_3a.document.execCommand("InsertHorizontalRule",false,null);break;case ect.Print:_3a.Print();break;case ect.TableInsertRowAbove:_3a.TableInsertRow();break;case ect.TableInsertRowBelow:_3a.TableInsertRow(true);break;case ect.TableInsertColumnRight:_3a.TableInsertColumn(true);break;case ect.TableInsertColumnLeft:_3a.TableInsertColumn();break;case ect.TableDeleteRow:_3a.TableDeleteRow();break;case ect.TableDeleteColumn:_3a.TableDeleteColumn();break;case ect.TableDeleteCell:_3a.TableDeleteCell();break;case ect.TableMergeCellRight:_3a.TableMergeCellRight();break;case ect.TableMergeCellDown:_3a.TableMergeCellDown();break;case ect.TableSplitCellHorizontal:_3a.TableSplitCellHorizontal();break;case ect.TableSplitCellVertical:_3a.TableSplitCellVertical();break;case ect.InsertForm:_3a.InsertFormElement("form");break;case ect.InsertButton:_3a.InsertFormElement("button");break;case ect.InsertCheckbox:_3a.InsertFormElement("checkbox");break;case ect.InsertHidden:_3a.InsertFormElement("hidden");break;case ect.InsertRadio:_3a.InsertFormElement("radio");break;case ect.InsertPassword:_3a.InsertFormElement("password");break;case ect.InsertReset:_3a.InsertFormElement("reset");break;case ect.InsertSelect:_3a.InsertFormElement("select");break;case ect.InsertSubmit:_3a.InsertFormElement("submit");break;case ect.InsertTextbox:_3a.InsertFormElement("textbox");break;case ect.InsertTextarea:_3a.InsertFormElement("textarea");break;case ect.RemoveHyperlink:_3a.SaveUndo("Remove Link");ComponentArt_RemoveElement(_3a,_3a.HasParent("A"));break;default:break;}_3a.RaiseContextChange();};function ComponentArt_Editor_ParseEditorCommandType(o){if(!isNaN(o)){return o;}else{if(!isNaN(o-0)){return o-0;}else{return cart_editor_command_type[o]-0;}}}function ComponentArt_Editor_CollapseMenus(_40){for(var i=_40.ChildControls.length-1;i>=0;i--){if(_40.ChildControls[i].constructor===ComponentArt.Web.UI.Menu){_40.ChildControls[i].Hide();}}}ComponentArt_Editor.prototype.AddContextMetric=function(_42,_43){this.ContextMetrics[_42]={"Function":_43,"LastValue":_43(this),"ListenerIndexes":[]};};ComponentArt_Editor.prototype.AddContextChangedEventListener=function(_44,_45){if(_45==null){var _46=this.ContextChangedListeners.Always.length;this.ContextChangedListeners.Always[_46]=_44;return;}else{var _46=this.ContextChangedListeners.Sometimes.length;this.ContextChangedListeners.Sometimes[_46]=_44;for(var i=0;i<_45.length;i++){var _48=_45[i];this.ContextMetrics[_48].ListenerIndexes[this.ContextMetrics[_48].ListenerIndexes.length]=_46;}return;}};function ComponentArt_Editor_HandleEditorBoxEvent(_49,_4a){var _4b=new Object();var _4c=new Object();var _4d=false;for(var _4e in _49.ContextMetrics){var _4f=_49.ContextMetrics[_4e];_4b[_4e]=_4f.Function(_49);if(_4b[_4e]!==_4f.LastValue){_4d=true;_4f.LastValue=_4b[_4e];for(var i=_4f.ListenerIndexes.length-1;i>=0;i--){_4c[_4f.ListenerIndexes[i]]=0;}}}if(_4d){for(var _51=_49.ContextChangedListeners.Always.length-1;_51>=0;_51--){_49.ContextChangedListeners.Always[_51](_49,_4b);}for(var _51 in _4c){_49.ContextChangedListeners.Sometimes[_51](_49,_4b);}}}function ComponentArt_Style(_52){this.Name=""+_52[0];this.Element=_52[1];this.ReplaceParagraphTag=!!_52[2];this.CssClass=_52[3];this.StyleString=_52[4];this.Style=_q104(this.StyleString);this.StyleLength=ComponentArt_Editor_MemberCount(this.Style);this.DropDownCssClass=_52[5];this.DropDownStyleString=_52[6];}function ComponentArt_Editor_CurrentStyle(_53){for(var i=0;i<_53.StylesIterator.length;i++){var _55=_53.StylesIterator[i];if(ComponentArt_Editor_StyleIsInEffect(_53,_55)){return _55;}}return null;}
