if(!window.ComponentArt_Upload_Loaded){ComponentArt.Web.UI.UploadFileChangeEventArgs=function(_1,_2){if(window.ComponentArt_Atlas){ComponentArt.Web.UI.UploadFileChangeEventArgs.initializeBase(this);}var _3=_2;var _4=_1;this.get_index=function(){return _3;};this.get_fileName=function(){return _4;};};ComponentArt.Web.UI.UploadErrorEventArgs=function(_5){if(window.ComponentArt_Atlas){ComponentArt.Web.UI.UploadErrorEventArgs.initializeBase(this);}var _6=_5;this.get_message=function(){return _6;};};if(window.ComponentArt_Atlas){ComponentArt.Web.UI.UploadFileChangeEventArgs.registerClass("ComponentArt.Web.UI.UploadFileChangeEventArgs",Sys.EventArgs);ComponentArt.Web.UI.UploadErrorEventArgs.registerClass("ComponentArt.Web.UI.UploadErrorEventArgs",Sys.EventArgs);}window.ComponentArt_Upload=function(id){this.Id=id;this.element=this.DomElement=document.getElementById(id);if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Upload.initializeBase(this,[this.element]);this.getDescriptor=function(){return _qEF(this.constructor);};this.dispose=function(){ComponentArt.Web.UI.Upload.callBaseMethod(this,"dispose");this.Dispose();};}};ComponentArt_Upload.prototype.PublicProperties=[["CallbackParameter"],["FileCount"],["Id"],["Uploading",1]];ComponentArt_Upload.prototype.PublicMethods=[["AddFile"],["ClearFiles"],["Dispose"],["GetFiles"],["RemoveFileAt"],["Upload"]];ComponentArt_Upload.prototype.PublicEvents=[["FileChange"],["Load"],["UploadBegin"],["UploadError"],["UploadEnd"]];_qEE(ComponentArt_Upload,"this");window.ComponentArt.Web.UI.Upload=window.ComponentArt_Upload;if(window.ComponentArt_Atlas){ComponentArt.Web.UI.Upload.registerClass("ComponentArt.Web.UI.Upload",Sys.UI.Control);if(Sys.TypeDescriptor){Sys.TypeDescriptor.addType("componentArtWebUI","upload",ComponentArt.Web.UI.Upload);}}ComponentArt_Upload.prototype.GetProperty=function(_8){return this[_8];};ComponentArt_Upload.prototype.SetProperty=function(_9,_a){this[_9]=_a;};ComponentArt_Upload.prototype.BeginProgress=function(){var _b=this.get_events().getHandler("uploadBegin");if(_b){_b(this,Sys.EventArgs.Empty);}this.CheckProgress();};ComponentArt_Upload.prototype.AddFile=function(_c){if(this.FileCount<this.MaximumFileCount){if(this.FileInputClientTemplateId){var _d=this.FileInputFields[this.FileInputFields.length]=document.createElement("input");_d.type="file";_d.id=_d.name=this.Id+"_FileInput"+this.FileInputIndex;_d.style.position="absolute";_d.onchange=new Function(this.Id+".FileChange("+this.FileInputIndex+")");_d.onmousemove=_d.onmouseover=new Function("e","o",this.Id+".FloaterMouseOver(e,o,"+this.FileInputIndex+")");_d.onmouseout=new Function("e","o",this.Id+".FloaterMouseOut(e,o,"+this.FileInputIndex+")");if(cart_browser_ie){_d.style.filter="alpha(opacity=0)";}else{_d.style.opacity=0;_d.style.setProperty("-moz-opacity",0,"");}this.Form.insertBefore(_d,this.Form.firstChild);}else{}this.FileInputIndex++;this.FileCount++;if(!_c){this.Render();}}};ComponentArt_Upload.prototype.ClearFiles=function(){var _e=this.GetFileInputs();for(var i=0;i<_e.length;i++){_qF2(_e[i]);}this.FileInputFields=[];this.FileCount=0;this.Render();};ComponentArt_Upload.prototype.Abort=function(){if(!this.Uploading){return;}if(window.stop){window.stop();}else{try{document.execCommand("Stop");}catch(ex){window.location.href=window.location.href;}}this.Uploading=false;this.EndProgress();};ComponentArt_Upload.prototype.Callback=function(){var url=location.href;url+=url.indexOf("?")>0?"&":"?";url+="CartUploadId="+this.UploadId+"&r="+Math.random()+"&Cart_"+this.Id+"_Callback=yes";if(this.CallbackParameter){url+="&Cart_"+this.Id+"_CallbackParameter="+encodeURIComponent(this.CallbackParameter);}var _11=this;var _12=false;var _13;function _q19E(){if(_13.readyState&&_13.readyState!=4&&_13.readyState!="complete"){return;}var _14=_12?_13.responseXML:_13;if(_14&&_14.documentElement&&_14.documentElement.nodeName=="UploadCallbackSuccess"){_11.UploadId=_14.documentElement.firstChild.nodeValue;}else{var _15=_11.get_events().getHandler("uploadError");if(_15){_15(_11,new ComponentArt.Web.UI.UploadErrorEventArgs("Unknown callback error."));}else{if(_13.status&&_13.status!=200&&_13.responseText){document.body.innerHTML=_13.responseText;}else{alert("Unknown callback error.");}}}}if(window.XMLHttpRequest){_12=true;var _13=new XMLHttpRequest();_13.onreadystatechange=_q19E;_13.open("GET",url,true);_13.send(null);}else{if(document.implementation&&document.implementation.createDocument){_13=document.implementation.createDocument("","",null);_13.onload=_q19E;}else{if(cart_browser_ie){var _16=this.Id+"_island";var _17=document.getElementById(_16);if(!_17){_17=document.createElement("xml");_17.id=_16;document.body.appendChild(_17);}if(_17.XMLDocument){_13=_17.XMLDocument;_13.onreadystatechange=_q19E;}else{return false;}}else{return false;}}}if(!_12){_13.async=true;try{_13.load(url);}catch(ex){_11.UploadError("Callback error: "+(ex.message?ex.message:ex));}}return true;};ComponentArt_Upload.prototype.HideInputs=function(){var _18=this.GetFileInputs();for(var i=0;i<_18.length;i++){_18[i].style.top="-1000px";_18[i].style.left="-1000px";}};ComponentArt_Upload.prototype.Dispose=function(){ComponentArt_Dispose(this);var _1a=this.GetFileInputs();for(var i=0;i<_1a.length;i++){_qF2(_1a[i]);}};ComponentArt_Upload.prototype.GetFileInputs=function(){var _1c=[];var _1d=this.Form.getElementsByTagName("input");for(var i=0;i<_1d.length;i++){if(_1d[i].type=="file"&&_1d[i].id&&_1d[i].id.indexOf(this.Id+"_FileInput")==0){_1c[_1c.length]=_1d[i];}}return _1c;};ComponentArt_Upload.prototype.GetFiles=function(){var _1f=[];var _20=this.GetFileInputs();for(var i=0;i<_20.length;i++){if(_20[i].value){_1f[_1f.length]=_20[i].value;}}return _1f;};ComponentArt_Upload.prototype.UpdateProgress=function(_22){if(!this.ProgressElement){if(this.ProgressDomElementId){this.ProgressElement=document.getElementById(this.ProgressDomElementId);}else{var _23=document.createElement("div");_23.style.position="absolute";_23.style.display="none";_23.style.left=_q85(this.element)+this.ProgressPopupOffsetX+"px";_23.style.top=_q86(this.element)+this.ProgressPopupOffsetY+"px";_23.style.zIndex=90211;document.body.insertBefore(_23,document.body.firstChild);this.ProgressElement=_23;}}if(this.ProgressElement){this.ProgressElement.innerHTML=this.GetTemplatedContent(this.ProgressClientTemplateId,this,_22);this.ProgressElement.style.display="";}};ComponentArt_Upload.prototype.CheckProgress=function(){if(this.CallingBack){return false;}var url="ComponentArtUploadProgress.axd?CartUploadId="+this.UploadId+"&r="+Math.random();var _25=this;var _26=false;var _27;function _q19E(){if(_27.readyState&&_27.readyState!=4&&_27.readyState!="complete"){return;}var _28=_26?_27.responseXML:_27;if(_28&&_28.documentElement&&_28.documentElement.firstChild){var _29=_28.documentElement.firstChild;if(_28.documentElement.nodeName=="UploadError"){var _2a=_29.nodeValue;_25.UploadError(_2a);}else{var _2b=_29.nodeValue;eval(_2b);if(UploadProgressData){_25.UploadProgressData=UploadProgressData;_25.UpdateProgress(UploadProgressData);if(UploadProgressData.Progress==1){_25.UploadComplete();}else{setTimeout(_25.Id+".CheckProgress()",_25.ProgressUpdateInterval);}}else{_25.UploadError("Invalid status data received from server.");}}}else{_25.UploadError("Error loading progress data.");}}if(window.XMLHttpRequest){_26=true;var _27=new XMLHttpRequest();_27.onreadystatechange=_q19E;_27.open("GET",url,true);_27.send(null);}else{if(document.implementation&&document.implementation.createDocument){_27=document.implementation.createDocument("","",null);_27.onload=_q19E;}else{if(cart_browser_ie){var _2c=this.Id+"_island";var _2d=document.getElementById(_2c);if(!_2d){_2d=document.createElement("xml");_2d.id=_2c;document.body.appendChild(_2d);}if(_2d.XMLDocument){_27=_2d.XMLDocument;_27.onreadystatechange=_q19E;}else{return false;}}else{return false;}}}if(!_26){_27.async=true;try{_27.load(url);}catch(ex){_25.UploadError("Error loading progress data: "+(ex.message?ex.message:ex));}}return true;};ComponentArt_Upload.prototype.EndProgress=function(){if(!this.ProgressDomElementId){_qF2(this.ProgressPopup);}else{if(this.UploadCompleteClientTemplateId){this.ProgressElement.innerHTML=this.GetTemplatedContent(this.UploadCompleteClientTemplateId,this,this.UploadProgressData);}}this.ProgressElement=null;var _2e=this.get_events().getHandler("uploadEnd");if(_2e){_2e(this,Sys.EventArgs.Empty);}};ComponentArt_Upload.prototype.FileChange=function(i){var _30=this.get_events().getHandler("fileChange");if(_30){var _31=document.getElementById(this.Id+"_FileInput"+i);_30(this,new ComponentArt.Web.UI.UploadFileChangeEventArgs(_31?_31.value:"",i));}this.Render();};ComponentArt_Upload.prototype.FloaterMouseOver=function(e,o,i){var _35=document.getElementById(this.Id+"_FileInputImage"+i);if(_35){var _36=cart_browser_ie?event.clientX+(document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):e.pageX;var _37=cart_browser_ie?event.clientY+(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):e.pageY;if(this.FileInputFields&&this.FileInputFields[i]&&!ComponentArt_IsOver(_35,_36,_37)){this.FileInputFields[i].style.top=_37+10+"px";this.FileInputFields[i].style.left=_36+10+"px";this.FileInputFields[i].blur();}else{if(this.FileInputHoverImageUrl){_35.src=this.FileInputHoverImageUrl;}}}};ComponentArt_Upload.prototype.FloaterMouseOut=function(e,o,i){if(this.FileInputHoverImageUrl){var _3b=document.getElementById(this.Id+"_FileInputImage"+i);if(_3b){try{if(!e&&cart_browser_ie){e=window.event;}if(ComponentArt_ToElement(e)==_3b){return;}}catch(ex){}_3b.src=this.FileInputImageUrl;if(this.FileInputFields&&this.FileInputFields[i]){this.FileInputFields[i].style.top="-1000px";this.FileInputFields[i].style.left="-1000px";}}}};ComponentArt_Upload.prototype.GetClientTemplate=function(sID){if(this.ClientTemplates){for(var i=0;i<this.ClientTemplates.length;i++){if(this.ClientTemplates[i][0]==sID){return this.ClientTemplates[i][1];}}}return null;};ComponentArt_Upload.prototype.GetTemplatedContent=function(_3e,_3f,_40){var _41=this.GetClientTemplate(_3e);if(_41){return ComponentArt_InstantiateClientTemplate(_41,_3f,_40);}else{return ("Template not found: "+_3e);}};ComponentArt_Upload.prototype.InitFileInputs=function(){this.FileCount=0;this.FileInputIndex=0;this.FileInputFields=[];for(var i=0;i<this.InitialFileCount;i++){this.AddFile();}};ComponentArt_Upload.prototype.Initialize=function(){_q131(this);ComponentArt_ClientStateControls[ComponentArt_ClientStateControls.length]=this;var _43=this.get_events().getHandler("load");if(_43){_43(this,Sys.EventArgs.Empty);}this.Form=document.forms[0];this.OriginalFormAction=this.Form.action;this.OriginalFormEncoding=this.Form.enctype?this.Form.enctype:this.Form.encoding;this.InitFileInputs();this.Render();};ComponentArt_Upload.prototype.RemoveFileAt=function(_44){if(_44>=0&&this.FileInputFields[_44]){_qF2(this.FileInputFields[_44]);for(var i=_44;i<this.FileInputFields.length-1;i++){this.FileInputFields[i]=this.FileInputFields[i+1];}this.FileInputFields.length--;this.FileCount--;}this.Render();};ComponentArt_Upload.prototype.Render=function(){if(this.StaticContent){return;}var _46=document.getElementById(this.Id);var _47=[];for(var i=0;i<Math.min(this.FileCount,this.MaximumFileCount);i++){if(this.FileInputClientTemplateId){var _49={"FileIndex":i,"FileName":""};if(this.FileInputFields[i]){_49.FileName=this.FileInputFields[i].value;}var _4a=this.GetTemplatedContent(this.FileInputClientTemplateId,this,_49);if(this.FileInputImageUrl){var _4b="#$FileInputImage";var _4c=[];_4c[_4c.length]="<img id=\""+this.Id+"_FileInputImage"+i+"\" src=\""+this.FileInputImageUrl+"\"";_4c[_4c.length]=" onmousemove=\""+this.Id+".RepositionFloater(event,this,"+i+")\"";_4c[_4c.length]=" />";_4a=_4a.replace(_4b,_4c.join(""));}_47[_47.length]=_4a;}else{_47[_47.length]="<input type=\"file\" id=\""+this.Id+"_FileInput"+i+"\" name=\""+this.Id+"_FileInput"+i+"\"";_47[_47.length]=" onchange=\""+this.Id+".FileChange("+i+")\"";_47[_47.length]=" /><br/>";this.StaticContent=true;}}_46.innerHTML=_47.join("");};ComponentArt_Upload.prototype.RepositionFloater=function(e,o,i){if(this.Uploading){return;}var x=cart_browser_ie?event.clientX+(document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):e.pageX;var y=cart_browser_ie?event.clientY+(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):e.pageY;if(this.FileInputFields&&this.FileInputFields[i]){if(this.element){var _52=0;for(var o=this.element;o&&o.parentNode;o=o.parentNode){if(o.style.zIndex){_52=o.style.zIndex;break;}}this.FileInputFields[i].style.zIndex=_52+1;}else{this.FileInputFields[i].style.zIndex=90230;}this.FileInputFields[i].style.top=y-Math.round(this.FileInputFields[i].offsetHeight)+10+"px";this.FileInputFields[i].style.left=x-Math.round(this.FileInputFields[i].offsetWidth)+10+"px";}};ComponentArt_Upload.prototype.RestoreForm=function(){this.Form.action=this.OriginalFormAction;this.Form.enctype=this.Form.encoding=this.OriginalFormEncoding;};ComponentArt_Upload.prototype.SaveData=function(){if(this.PostingBack||this.GetFiles().length==0){return;}setTimeout(this.Id+".BeginProgress()",10);this.Form.enctype=this.Form.encoding="multipart/form-data";this.Form.action+=(this.Form.action.indexOf("?")>0?"&":"?")+"CartUploadId="+this.UploadId;this.Uploading=true;this.HideInputs();};ComponentArt_Upload.prototype.DisableOtherInputs=function(){var _53=this.Form.getElementsByTagName("input");for(var i=0;i<_53.length;i++){if(_53[i].type=="file"&&!_53[i].disabled&&!(_53[i].id&&_53[i].id.indexOf(this.Id+"_FileInput")==0)){_53[i].disabled=true;_53[i].disabledByCA=true;}}};ComponentArt_Upload.prototype.EnableOtherInputs=function(){var _55=this.Form.getElementsByTagName("input");for(var i=0;i<_55.length;i++){if(_55[i].type=="file"&&_55[i].disabledByCA){_55[i].disabled=false;_55[i].disabledByCA=false;}}};ComponentArt_Upload.prototype.Upload=function(){if(this.GetFiles().length>0){this.SaveData();this.DisableOtherInputs();this.Form.submit();this.EnableOtherInputs();}};ComponentArt_Upload.prototype.UploadComplete=function(){if(window.stop){window.stop();}else{try{document.execCommand("Stop");}catch(ex){window.location.href=window.location.href;}}this.Uploading=false;this.EndProgress();this.RestoreForm();if(this.AutoPostBack){var _57=this.Form.getElementsByTagName("input");for(var i=0;i<_57.length;i++){if(_57[i].type=="file"){_qF2(_57[i]);}}this.PostingBack=true;this.Postback();}else{this.Callback();}};ComponentArt_Upload.prototype.UploadError=function(_59){if(window.stop){window.stop();}else{try{document.execCommand("Stop");}catch(ex){window.location.href=window.location.href;}}this.Uploading=false;var _5a=this.get_events().getHandler("uploadError");if(_5a){_5a(this,new ComponentArt.Web.UI.UploadErrorEventArgs(_59));}else{alert("Upload error: "+_59);}if(this.UploadErrorClientTemplateId&&this.ProgressElement){this.ProgressElement.innerHTML=this.GetTemplatedContent(this.UploadErrorClientTemplateId,this,_59);}};window.ComponentArt_IsOver=function(_5b,x,y){var ox=_q85(_5b);var oy=_q86(_5b);var ow=_5b.offsetWidth;var oh=_5b.offsetHeight;return (x>=ox&&x<=ox+ow&&y>=oy&&y<=oy+oh);};window.ComponentArt_Upload_Loaded=true;}
